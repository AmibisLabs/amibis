<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OMiSCID(aka O3MiSCID): Omiscid::XMLTreeParser Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="namespace_omiscid.html">Omiscid</a>::<a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html">XMLTreeParser</a></div>
<h1>Omiscid::XMLTreeParser Class Reference</h1><!-- doxytag: class="Omiscid::XMLTreeParser" --><!-- doxytag: inherits="Omiscid::Thread,Omiscid::MsgSocketCallbackObject" -->Class to receive and parse and store XML <a class="el" href="class_omiscid_1_1_message.html">Message</a>.
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_x_m_l_tree_parser_8h-source.html">ServiceControl/XMLTreeParser.h</a>&gt;</code>
<p>
<p>Inheritance diagram for Omiscid::XMLTreeParser:
<p><center><img src="class_omiscid_1_1_x_m_l_tree_parser.png" usemap="#Omiscid::XMLTreeParser_map" border="0" alt=""></center>
<map name="Omiscid::XMLTreeParser_map">
<area href="class_omiscid_1_1_thread.html" alt="Omiscid::Thread" shape="rect" coords="55,0,266,24">
<area href="class_omiscid_1_1_msg_socket_callback_object.html" alt="Omiscid::MsgSocketCallbackObject" shape="rect" coords="276,0,487,24">
<area href="class_omiscid_1_1_control_client.html" alt="Omiscid::ControlClient" shape="rect" coords="0,112,211,136">
<area href="class_omiscid_1_1_control_server.html" alt="Omiscid::ControlServer" shape="rect" coords="331,112,542,136">
<area href="class_omiscid_1_1_service_proxy.html" alt="Omiscid::ServiceProxy" shape="rect" coords="0,168,211,192">
<area href="class_omiscid_1_1_service.html" alt="Omiscid::Service" shape="rect" coords="221,168,432,192">
<area href="class_omiscid_1_1_service_from_x_m_l.html" alt="Omiscid::ServiceFromXML" shape="rect" coords="442,168,653,192">
</map>
<a href="class_omiscid_1_1_x_m_l_tree_parser-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="300d78784588580c6c11de30b06f2e35"></a><!-- doxytag: member="Omiscid::XMLTreeParser::XMLTreeParser" ref="300d78784588580c6c11de30b06f2e35" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#300d78784588580c6c11de30b06f2e35">XMLTreeParser</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="15749ca0a936028a0281d3243739761b"></a><!-- doxytag: member="Omiscid::XMLTreeParser::~XMLTreeParser" ref="15749ca0a936028a0281d3243739761b" args="()" -->
virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#15749ca0a936028a0281d3243739761b">~XMLTreeParser</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Desctructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">xmlDocPtr&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#7942d0be9817b85d62e83b468b25ad2a">ParseMessage</a> (int length, unsigned char *buffer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse a message and Create a XML tree.  <a href="#7942d0be9817b85d62e83b468b25ad2a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#16239df8feb0ba8805711a0db3f89922">PushMessage</a> (<a class="el" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a> *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new parsed message to the list.  <a href="#16239df8feb0ba8805711a0db3f89922"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#e4355cf61e9e97fc84b66b68020c7f3f">ProcessMessages</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">process parsed message that are waiting.  <a href="#e4355cf61e9e97fc84b66b68020c7f3f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#dde42a7d0018818e141a85746918c69a">ProcessAMessage</a> (<a class="el" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a> *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">processing to apply to waiting message.  <a href="#dde42a7d0018818e141a85746918c69a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#119a9228756a56f5737a1d82208f9a54">GetMessage</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the waiting message.  <a href="#119a9228756a56f5737a1d82208f9a54"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a69363c5c8d043c0b9e6ed402c27e27d"></a><!-- doxytag: member="Omiscid::XMLTreeParser::ClearMessages" ref="a69363c5c8d043c0b9e6ed402c27e27d" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#a69363c5c8d043c0b9e6ed402c27e27d">ClearMessages</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">clear all the waiting message. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#ada7376dbb4b8a331a2588121579934d">WaitForMessage</a> (unsigned long timer=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for new message.  <a href="#ada7376dbb4b8a331a2588121579934d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#afc2b76af255ea2184328fa88d4ad4a8">HasMessages</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Presence of waiting message.  <a href="#afc2b76af255ea2184328fa88d4ad4a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#11439866f24e497babf86cf658c8514d">GetNbMessages</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the number of waiting messages.  <a href="#11439866f24e497babf86cf658c8514d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#439494a5e86fb6639a6e493acbe10294">Receive</a> (<a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a> &amp;ConnectionPoint, <a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a> &amp;cd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback for reception.  <a href="#439494a5e86fb6639a6e493acbe10294"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void FUNCTION_CALL_TYPE&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#95ab3b69615221fa672b2f841cd624c6">Run</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Loop where message are processed when they arrive.  <a href="#95ab3b69615221fa672b2f841cd624c6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">xmlDocPtr&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#6e0687287efc915021091dff1850683a">ParseFile</a> (const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a> filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a tree structure from XML in a file.  <a href="#6e0687287efc915021091dff1850683a"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Class to receive and parse and store XML <a class="el" href="class_omiscid_1_1_message.html">Message</a>.
<p>
Provides a callback methods for the received message by <a class="el" href="class_omiscid_1_1_tcp_client.html">TcpClient</a>, <a class="el" href="class_omiscid_1_1_tcp_server.html">TcpServer</a> or <a class="el" href="class_omiscid_1_1_connector.html">Connector</a>. The message are parsed and pushed in a list. There, they wait for processing. It is similar to <a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a>, with a message processing to change XML message in XML tree. This class is used also to call parse method of the library XML 2 (example ParseFile) <dl class="author" compact><dt><b>Author:</b></dt><dd>Sebastien Pesnel </dd></dl>

<p>

<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8h-source.html#l00112">112</a> of file <a class="el" href="_x_m_l_tree_parser_8h-source.html">XMLTreeParser.h</a>.<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="7942d0be9817b85d62e83b468b25ad2a"></a><!-- doxytag: member="Omiscid::XMLTreeParser::ParseMessage" ref="7942d0be9817b85d62e83b468b25ad2a" args="(int length, unsigned char *buffer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">xmlDocPtr XMLTreeParser::ParseMessage           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>buffer</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Parse a message and Create a XML tree.
<p>
Parse a message containing in a buffer of byte, and return a tree generated according to the XML message. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>[in] the length of the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>[in] array containing the byte of the message </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>NULL if parsing failed, else return a pointer on a structure containing the built tree. </dd></dl>

<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00168">168</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
Referenced by <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00173">Receive()</a>.<div class="fragment"><pre class="fragment"><a name="l00169"></a>00169 {
<a name="l00170"></a>00170     <span class="keywordflow">return</span> xmlParseMemory((<span class="keyword">const</span> <span class="keywordtype">char</span>*)buffer, length);
<a name="l00171"></a>00171 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="16239df8feb0ba8805711a0db3f89922"></a><!-- doxytag: member="Omiscid::XMLTreeParser::PushMessage" ref="16239df8feb0ba8805711a0db3f89922" args="(XMLMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XMLTreeParser::PushMessage           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a new parsed message to the list.
<p>
This message is waiting to be processed. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>a new parsed message </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00187">187</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_event_8cpp-source.html#l00031">Omiscid::Event::Reset()</a>, and <a class="el" href="_event_8cpp-source.html#l00038">Omiscid::Event::Signal()</a>.
<p>
Referenced by <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00173">Receive()</a>.<div class="fragment"><pre class="fragment"><a name="l00188"></a>00188 {
<a name="l00189"></a>00189     listXMLMsg.Lock();
<a name="l00190"></a>00190     listXMLMsg.Add(msg);
<a name="l00191"></a>00191     event.<a class="code" href="class_omiscid_1_1_event.html#b2f21cd732a591e6eba5efd09e4a89f4">Signal</a>();
<a name="l00192"></a>00192     event.<a class="code" href="class_omiscid_1_1_event.html#fed31be0b4f98fb83163a4d725886e81">Reset</a>();
<a name="l00193"></a>00193     listXMLMsg.Unlock();
<a name="l00194"></a>00194 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e4355cf61e9e97fc84b66b68020c7f3f"></a><!-- doxytag: member="Omiscid::XMLTreeParser::ProcessMessages" ref="e4355cf61e9e97fc84b66b68020c7f3f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XMLTreeParser::ProcessMessages           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
process parsed message that are waiting.
<p>
Call on each message the methods ProcessAMessage and then delete the message. <dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of processed message </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html#dde42a7d0018818e141a85746918c69a">ProcessAMessage</a> </dd></dl>

<p>
Reimplemented in <a class="el" href="class_omiscid_1_1_control_server.html#9721b438e8211dcb79a624c8fdb8bd1a">Omiscid::ControlServer</a>.
<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00196">196</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_simple_exception_8h-source.html#l00063">Omiscid::SimpleException::err</a>, <a class="el" href="_simple_exception_8cpp-source.html#l00035">Omiscid::SimpleException::GetExceptionType()</a>, <a class="el" href="_simple_string_8cpp-source.html#l00921">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, <a class="el" href="_system_2_system_2_config_8h-source.html#l00234">Omiscid::OmiscidTrace()</a>, and <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00221">ProcessAMessage()</a>.
<p>
Referenced by <a class="el" href="_control_server_8cpp-source.html#l00978">Omiscid::ControlServer::ProcessMessages()</a>, and <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00271">Run()</a>.<div class="fragment"><pre class="fragment"><a name="l00197"></a>00197 {
<a name="l00198"></a>00198     listXMLMsg.Lock();
<a name="l00199"></a>00199     <span class="keywordtype">int</span> nb = 0;
<a name="l00200"></a>00200     <a class="code" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a>* msg = NULL;
<a name="l00201"></a>00201     <span class="keywordflow">while</span>( listXMLMsg.IsNotEmpty() )
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203         msg = listXMLMsg.ExtractFirst();
<a name="l00204"></a>00204         <span class="keywordflow">try</span>
<a name="l00205"></a>00205         {
<a name="l00206"></a>00206             <a class="code" href="class_omiscid_1_1_x_m_l_tree_parser.html#dde42a7d0018818e141a85746918c69a">ProcessAMessage</a>(msg);
<a name="l00207"></a>00207         }
<a name="l00208"></a>00208         <span class="keywordflow">catch</span>( <a class="code" href="class_omiscid_1_1_simple_exception.html">SimpleException</a> &amp;e )
<a name="l00209"></a>00209         {
<a name="l00210"></a>00210             <a class="code" href="namespace_omiscid.html#75386ddb9b14af103045f0df7c2b2429">OmiscidTrace</a>( <span class="stringliteral">"'%s' occurs when processing XML message : %s (%d)\n"</span>, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#d80b3d2cdd50ac5ae35bfe2352ef85eb">GetExceptionType</a>().<a class="code" href="class_omiscid_1_1_simple_string.html#073b80f513204da691abc6b2f9b03338">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#073b80f513204da691abc6b2f9b03338">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#25a4d280190281495a5f85fa4dca1319">err</a> );
<a name="l00211"></a>00211         }
<a name="l00212"></a>00212         <span class="keyword">delete</span> msg;
<a name="l00213"></a>00213         <span class="comment">// listXMLMsg.RemoveCurrent();</span>
<a name="l00214"></a>00214         nb++;
<a name="l00215"></a>00215     }
<a name="l00216"></a>00216     listXMLMsg.Unlock();
<a name="l00217"></a>00217     <span class="keywordflow">return</span> nb;
<a name="l00218"></a>00218 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dde42a7d0018818e141a85746918c69a"></a><!-- doxytag: member="Omiscid::XMLTreeParser::ProcessAMessage" ref="dde42a7d0018818e141a85746918c69a" args="(XMLMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XMLTreeParser::ProcessAMessage           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
processing to apply to waiting message.
<p>
Must be reimplemented. Default implementation display the parsed message. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>message to process </td></tr>
  </table>
</dl>

<p>
Reimplemented in <a class="el" href="class_omiscid_1_1_control_client.html#05bf5e6add512055f263dd101785be53">Omiscid::ControlClient</a>, and <a class="el" href="class_omiscid_1_1_control_server.html#edea1d536351e3b42dc0745d1c4e0840">Omiscid::ControlServer</a>.
<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00221">221</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00067">Omiscid::XMLMessage::Display()</a>, and <a class="el" href="_system_2_system_2_config_8h-source.html#l00234">Omiscid::OmiscidTrace()</a>.
<p>
Referenced by <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00196">ProcessMessages()</a>.<div class="fragment"><pre class="fragment"><a name="l00222"></a>00222 {
<a name="l00223"></a>00223     <a class="code" href="namespace_omiscid.html#75386ddb9b14af103045f0df7c2b2429">OmiscidTrace</a>( <span class="stringliteral">"XMLTreeParser::ProcessAMessage\n"</span>);
<a name="l00224"></a>00224     msg-&gt;<a class="code" href="class_omiscid_1_1_x_m_l_message.html#1396ef857338dfe077cbebbf8e9550d7">Display</a>();
<a name="l00225"></a>00225 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="119a9228756a56f5737a1d82208f9a54"></a><!-- doxytag: member="Omiscid::XMLTreeParser::GetMessage" ref="119a9228756a56f5737a1d82208f9a54" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a> * XMLTreeParser::GetMessage           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the waiting message.
<p>
At each call, return a new waiting message. Return NULL when there are no more message to process. The returned message must be deleted by the user. It is an alternative to ProcessMessage. <dl class="return" compact><dt><b>Returns:</b></dt><dd>a waiting message, NULL if no more message. </dd></dl>

<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00227">227</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.<div class="fragment"><pre class="fragment"><a name="l00228"></a>00228 {
<a name="l00229"></a>00229     <a class="code" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a>* msg = NULL;
<a name="l00230"></a>00230     listXMLMsg.Lock();
<a name="l00231"></a>00231     <span class="keywordflow">if</span>(listXMLMsg.GetNumberOfElements())
<a name="l00232"></a>00232     {
<a name="l00233"></a>00233         listXMLMsg.First();
<a name="l00234"></a>00234         msg = listXMLMsg.GetCurrent();
<a name="l00235"></a>00235         listXMLMsg.RemoveCurrent();
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     listXMLMsg.Unlock();
<a name="l00238"></a>00238     <span class="keywordflow">return</span> msg;
<a name="l00239"></a>00239 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ada7376dbb4b8a331a2588121579934d"></a><!-- doxytag: member="Omiscid::XMLTreeParser::WaitForMessage" ref="ada7376dbb4b8a331a2588121579934d" args="(unsigned long timer=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XMLTreeParser::WaitForMessage           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>timer</em> = <code>0</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Wait for new message.
<p>
Wait until there is waiting message, exit before if max waiting time expired. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer</em>&nbsp;</td><td>max time to wait (0 for infinite) (time in millisecond) </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if exit because the arrival of a new message, false if exit because of time. </dd></dl>

<p>
Reimplemented in <a class="el" href="class_omiscid_1_1_control_server.html#73ee83d8c3aa3056c084bc351d2e891d">Omiscid::ControlServer</a>.
<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00260">260</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00291">HasMessages()</a>, <a class="el" href="_event_8cpp-source.html#l00031">Omiscid::Event::Reset()</a>, and <a class="el" href="_event_8cpp-source.html#l00049">Omiscid::Event::Wait()</a>.
<p>
Referenced by <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00271">Run()</a>, and <a class="el" href="_control_server_8cpp-source.html#l00983">Omiscid::ControlServer::WaitForMessage()</a>.<div class="fragment"><pre class="fragment"><a name="l00261"></a>00261 {
<a name="l00262"></a>00262     event.<a class="code" href="class_omiscid_1_1_event.html#fed31be0b4f98fb83163a4d725886e81">Reset</a>();
<a name="l00263"></a>00263     <span class="keywordflow">if</span>(!<a class="code" href="class_omiscid_1_1_x_m_l_tree_parser.html#afc2b76af255ea2184328fa88d4ad4a8">HasMessages</a>())
<a name="l00264"></a>00264     {
<a name="l00265"></a>00265         <span class="keywordflow">return</span> event.<a class="code" href="class_omiscid_1_1_event.html#a08f1ffcf64f950b8f34e24dc97a38a8">Wait</a>(timer);
<a name="l00266"></a>00266     }
<a name="l00267"></a>00267     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00268"></a>00268 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="afc2b76af255ea2184328fa88d4ad4a8"></a><!-- doxytag: member="Omiscid::XMLTreeParser::HasMessages" ref="afc2b76af255ea2184328fa88d4ad4a8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XMLTreeParser::HasMessages           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Presence of waiting message.
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if there is waiting message </dd></dl>

<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00291">291</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00252">GetNbMessages()</a>.
<p>
Referenced by <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00260">WaitForMessage()</a>.<div class="fragment"><pre class="fragment"><a name="l00292"></a>00292 {
<a name="l00293"></a>00293     <span class="keywordflow">return</span> <a class="code" href="class_omiscid_1_1_x_m_l_tree_parser.html#11439866f24e497babf86cf658c8514d">GetNbMessages</a>() != 0;
<a name="l00294"></a>00294 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="11439866f24e497babf86cf658c8514d"></a><!-- doxytag: member="Omiscid::XMLTreeParser::GetNbMessages" ref="11439866f24e497babf86cf658c8514d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int XMLTreeParser::GetNbMessages           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the number of waiting messages.
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of waiting message </dd></dl>

<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00252">252</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
Referenced by <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00291">HasMessages()</a>.<div class="fragment"><pre class="fragment"><a name="l00253"></a>00253 {
<a name="l00254"></a>00254     listXMLMsg.Lock();
<a name="l00255"></a>00255     <span class="keywordtype">int</span> nb = listXMLMsg.GetNumberOfElements();
<a name="l00256"></a>00256     listXMLMsg.Unlock();
<a name="l00257"></a>00257     <span class="keywordflow">return</span> nb;
<a name="l00258"></a>00258 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="439494a5e86fb6639a6e493acbe10294"></a><!-- doxytag: member="Omiscid::XMLTreeParser::Receive" ref="439494a5e86fb6639a6e493acbe10294" args="(MsgSocket &amp;ConnectionPoint, MsgSocketCallBackData &amp;cd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XMLTreeParser::Receive           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>ConnectionPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>cd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Callback for reception.
<p>
Function that can be given as callback for TCPClient, TCPServer, ... The first user parameter to give is a pointer on an <a class="el" href="class_omiscid_1_1_x_m_l_tree_parser.html">XMLTreeParser</a> object, the second parameter is not used. The user parameters will be present in the <a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a> object. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cd</em>&nbsp;</td><td>a <a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a> object who contains the pointer define by user, and the new message buffer. </td></tr>
  </table>
</dl>

<p>
Implements <a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">Omiscid::MsgSocketCallbackObject</a>.
<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00173">173</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_x_m_l_tree_parser_8h-source.html#l00057">Omiscid::XMLMessage::doc</a>, <a class="el" href="_message_8cpp-source.html#l00031">Omiscid::Message::GetBuffer()</a>, <a class="el" href="_message_8cpp-source.html#l00036">Omiscid::Message::GetLength()</a>, <a class="el" href="_message_8cpp-source.html#l00051">Omiscid::Message::GetMsgId()</a>, <a class="el" href="_message_8cpp-source.html#l00041">Omiscid::Message::GetOrigine()</a>, <a class="el" href="_message_8cpp-source.html#l00046">Omiscid::Message::GetPeerId()</a>, <a class="el" href="_x_m_l_tree_parser_8h-source.html#l00060">Omiscid::XMLMessage::mid</a>, <a class="el" href="_msg_socket_8h-source.html#l00038">Omiscid::MsgSocketCallBackData::Msg</a>, <a class="el" href="_system_2_system_2_config_8h-source.html#l00209">OMISCID_TLM</a>, <a class="el" href="_x_m_l_tree_parser_8h-source.html#l00058">Omiscid::XMLMessage::origine</a>, <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00168">ParseMessage()</a>, <a class="el" href="_x_m_l_tree_parser_8h-source.html#l00059">Omiscid::XMLMessage::pid</a>, and <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00187">PushMessage()</a>.<div class="fragment"><pre class="fragment"><a name="l00174"></a>00174 {
<a name="l00175"></a>00175     xmlDocPtr doc = <a class="code" href="class_omiscid_1_1_x_m_l_tree_parser.html#7942d0be9817b85d62e83b468b25ad2a">ParseMessage</a>(cd.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#8280558340d705cb00e23e2a7e46cf11">Msg</a>.<a class="code" href="class_omiscid_1_1_message.html#31260bb8c257787afdc93f4317cd79cf">GetLength</a>(), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)cd.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#8280558340d705cb00e23e2a7e46cf11">Msg</a>.<a class="code" href="class_omiscid_1_1_message.html#7f8d43e07d910c760aed66343d2a57ae">GetBuffer</a>());
<a name="l00176"></a>00176     <span class="keywordflow">if</span>( doc )
<a name="l00177"></a>00177     {
<a name="l00178"></a>00178         <a class="code" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a>* msg = <span class="keyword">new</span> <a class="code" href="_system_2_system_2_config_8h.html#87a9b7794230e905ae0170f5782a08cd">OMISCID_TLM</a> <a class="code" href="class_omiscid_1_1_x_m_l_message.html">XMLMessage</a>();
<a name="l00179"></a>00179         msg-&gt;<a class="code" href="class_omiscid_1_1_x_m_l_message.html#67ff6f95c99dc85c4852fd8ebcaf5b9b">doc</a> = doc;
<a name="l00180"></a>00180         msg-&gt;<a class="code" href="class_omiscid_1_1_x_m_l_message.html#ab4e6546d58f829bf3c61664f6f0d615">origine</a> = cd.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#8280558340d705cb00e23e2a7e46cf11">Msg</a>.<a class="code" href="class_omiscid_1_1_message.html#a90e00aeb13d2f98fe7f8c70e86d1ddc">GetOrigine</a>();
<a name="l00181"></a>00181         msg-&gt;<a class="code" href="class_omiscid_1_1_x_m_l_message.html#125586c4da5680bba5fc20c35d9219fc">pid</a> = cd.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#8280558340d705cb00e23e2a7e46cf11">Msg</a>.<a class="code" href="class_omiscid_1_1_message.html#9f21d85562f13fe7aea27a095be93eec">GetPeerId</a>();
<a name="l00182"></a>00182         msg-&gt;<a class="code" href="class_omiscid_1_1_x_m_l_message.html#805e6426ea0fbdb0bbf17814a90c4886">mid</a> = cd.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#8280558340d705cb00e23e2a7e46cf11">Msg</a>.<a class="code" href="class_omiscid_1_1_message.html#00e7fc454005ca0ccf42355cdc67bdec">GetMsgId</a>();
<a name="l00183"></a>00183         <a class="code" href="class_omiscid_1_1_x_m_l_tree_parser.html#16239df8feb0ba8805711a0db3f89922">PushMessage</a>(msg);
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="95ab3b69615221fa672b2f841cd624c6"></a><!-- doxytag: member="Omiscid::XMLTreeParser::Run" ref="95ab3b69615221fa672b2f841cd624c6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FUNCTION_CALL_TYPE XMLTreeParser::Run           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Loop where message are processed when they arrive.
<p>
Enable to process automatically the message by a new thread. This thread is launched by a call to the method StartThread
<p>
Implements <a class="el" href="class_omiscid_1_1_thread.html#9527b3c79a6302f29d0bbc774e707f53">Omiscid::Thread</a>.
<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00271">271</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_simple_string_8cpp-source.html#l00921">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, <a class="el" href="_system_2_system_2_config_8h-source.html#l00234">Omiscid::OmiscidTrace()</a>, <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00196">ProcessMessages()</a>, <a class="el" href="_thread_8cpp-source.html#l00161">Omiscid::Thread::StopPending()</a>, and <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00260">WaitForMessage()</a>.<div class="fragment"><pre class="fragment"><a name="l00272"></a>00272 {
<a name="l00273"></a>00273     <span class="keywordflow">while</span>(!<a class="code" href="class_omiscid_1_1_thread.html#6ea60778f06e88bfb8061a6c9c201208">StopPending</a>())
<a name="l00274"></a>00274     {
<a name="l00275"></a>00275         <span class="keywordflow">try</span>
<a name="l00276"></a>00276         {
<a name="l00277"></a>00277             <span class="keywordflow">if</span>(<a class="code" href="class_omiscid_1_1_x_m_l_tree_parser.html#ada7376dbb4b8a331a2588121579934d">WaitForMessage</a>(10))
<a name="l00278"></a>00278             {
<a name="l00279"></a>00279                 <a class="code" href="class_omiscid_1_1_x_m_l_tree_parser.html#e4355cf61e9e97fc84b66b68020c7f3f">ProcessMessages</a>();
<a name="l00280"></a>00280             }
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282         <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_simple_exception.html">SimpleException</a>&amp; e)
<a name="l00283"></a>00283         {
<a name="l00284"></a>00284             <a class="code" href="namespace_omiscid.html#75386ddb9b14af103045f0df7c2b2429">OmiscidTrace</a>( <span class="stringliteral">"XMLTreeParser::Run: ExceptionRaisedFromDown (%s)\n"</span>, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#073b80f513204da691abc6b2f9b03338">GetStr</a>() );
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287
<a name="l00288"></a>00288     <span class="comment">// OmiscidTrace( "ThreadWasAskedToDie\n" );</span>
<a name="l00289"></a>00289 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6e0687287efc915021091dff1850683a"></a><!-- doxytag: member="Omiscid::XMLTreeParser::ParseFile" ref="6e0687287efc915021091dff1850683a" args="(const SimpleString filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">xmlDocPtr XMLTreeParser::ParseFile           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a>&nbsp;</td>
          <td class="paramname"> <em>filename</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate a tree structure from XML in a file.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>[in] file to parse </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the tree structure, NULL if parsing failed </dd></dl>

<p>
Definition at line <a class="el" href="_x_m_l_tree_parser_8cpp-source.html#l00163">163</a> of file <a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a>.
<p>
References <a class="el" href="_simple_string_8cpp-source.html#l00921">Omiscid::SimpleString::GetStr()</a>.
<p>
Referenced by <a class="el" href="_service_from_x_m_l_8cpp-source.html#l00011">Omiscid::ServiceFromXML::ServiceFromXML()</a>.<div class="fragment"><pre class="fragment"><a name="l00164"></a>00164 {
<a name="l00165"></a>00165     <span class="keywordflow">return</span> xmlParseFile(filename.<a class="code" href="class_omiscid_1_1_simple_string.html#073b80f513204da691abc6b2f9b03338">GetStr</a>());
<a name="l00166"></a>00166 }
</pre></div>
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>ServiceControl/ServiceControl/<a class="el" href="_x_m_l_tree_parser_8h-source.html">XMLTreeParser.h</a><li>ServiceControl/<a class="el" href="_x_m_l_tree_parser_8cpp-source.html">XMLTreeParser.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Feb 1 14:26:37 2007 for OMiSCID(aka O3MiSCID) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>

