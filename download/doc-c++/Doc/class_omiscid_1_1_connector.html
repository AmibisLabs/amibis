<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OMiSCID(aka O3MiSCID): Omiscid::Connector Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="namespace_omiscid.html">Omiscid</a>::<a class="el" href="class_omiscid_1_1_connector.html">Connector</a></div>
<h1>Omiscid::Connector Class Reference</h1><!-- doxytag: class="Omiscid::Connector" --><!-- doxytag: inherits="Omiscid::TcpServer,Omiscid::UdpExchange" -->Group TCP and UDP communication means.
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_connector_8h-source.html">Com/Connector.h</a>&gt;</code>
<p>
<p>Inheritance diagram for Omiscid::Connector:
<p><center><img src="class_omiscid_1_1_connector.png" usemap="#Omiscid::Connector_map" border="0" alt=""></center>
<map name="Omiscid::Connector_map">
<area href="class_omiscid_1_1_tcp_server.html" alt="Omiscid::TcpServer" shape="rect" coords="75,112,216,136">
<area href="class_omiscid_1_1_udp_exchange.html" alt="Omiscid::UdpExchange" shape="rect" coords="377,112,518,136">
<area href="class_omiscid_1_1_msg_socket.html" alt="Omiscid::MsgSocket" shape="rect" coords="0,56,141,80">
<area href="class_omiscid_1_1_com_tools.html" alt="Omiscid::ComTools" shape="rect" coords="151,56,292,80">
<area href="class_omiscid_1_1_msg_socket.html" alt="Omiscid::MsgSocket" shape="rect" coords="302,56,443,80">
<area href="class_omiscid_1_1_com_tools.html" alt="Omiscid::ComTools" shape="rect" coords="453,56,594,80">
<area href="class_omiscid_1_1_thread.html" alt="Omiscid::Thread" shape="rect" coords="0,0,141,24">
<area href="class_omiscid_1_1_thread.html" alt="Omiscid::Thread" shape="rect" coords="302,0,443,24">
</map>
<a href="class_omiscid_1_1_connector-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#19a1a94cd477e5c3dffc5fb26802b64e">Connector</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#19a1a94cd477e5c3dffc5fb26802b64e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0f084edc18ed6e3a25314689d5bf9244"></a><!-- doxytag: member="Omiscid::Connector::~Connector" ref="0f084edc18ed6e3a25314689d5bf9244" args="()" -->
virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#0f084edc18ed6e3a25314689d5bf9244">~Connector</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#d728d96ff5786432d5467ac728d70015">Create</a> (int port_tcp=0, int port_udp=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Run a <a class="el" href="class_omiscid_1_1_tcp_server.html">TcpServer</a>, an <a class="el" href="class_omiscid_1_1_udp_exchange.html">UdpExchange</a> object.  <a href="#d728d96ff5786432d5467ac728d70015"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#628c32df4212a5ba7c79dd2b48181313">ConnectTo</a> (const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a> addr, int port_tcp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Connection as client.  <a href="#628c32df4212a5ba7c79dd2b48181313"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#fec46fd4941842058199a8b15ad6b948">SendToAll</a> (int len, const char *buf, bool fastsend=false)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message on all the existing connection.  <a href="#fec46fd4941842058199a8b15ad6b948"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#79ee5193ac9a4f25ca2fa53de9128e5c">SendToPeer</a> (int len, const char *buf, unsigned int pid, bool fastsend=false)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message to a particular client define par its identifier.  <a href="#79ee5193ac9a4f25ca2fa53de9128e5c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#f08cf8ae1470bc37400406a97938feb5">SetServiceId</a> (unsigned int pid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define the service identifier associated to this object.  <a href="#f08cf8ae1470bc37400406a97938feb5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#7590581670e089568b99942dc2acd07b">GetServiceId</a> () const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the service id.  <a href="#7590581670e089568b99942dc2acd07b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#d7f28167c7115cf3b147c2b494fb9ece">GetTcpPort</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the TCP port.  <a href="#d7f28167c7115cf3b147c2b494fb9ece"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#7124a1ec2a8829463729d201c08391cb">GetUdpPort</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the TCP port.  <a href="#7124a1ec2a8829463729d201c08391cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#c3844c72f8a2dde74236a89345510398">GetNbConnection</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the number of connections.  <a href="#c3844c72f8a2dde74236a89345510398"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="07c39beef59e37166515e757dba5e0a3"></a><!-- doxytag: member="Omiscid::Connector::Disconnect" ref="07c39beef59e37166515e757dba5e0a3" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#07c39beef59e37166515e757dba5e0a3">Disconnect</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">disconnect all connection to this <a class="el" href="class_omiscid_1_1_connector.html">Connector</a> <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a75b8840b61732fb59498c90fa865cda"></a><!-- doxytag: member="Omiscid::Connector::DisconnectPeerId" ref="a75b8840b61732fb59498c90fa865cda" args="(unsigned int PeerId)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#a75b8840b61732fb59498c90fa865cda">DisconnectPeerId</a> (unsigned int PeerId)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">disconnect all connection to this <a class="el" href="class_omiscid_1_1_connector.html">Connector</a> <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#12d389fb6bcee1d43ae4ef20c57a1549">GetListPeerId</a> (<a class="el" href="class_omiscid_1_1_simple_list.html">SimpleList</a>&lt; unsigned int &gt; &amp;listId)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of peer id for all the connections.  <a href="#12d389fb6bcee1d43ae4ef20c57a1549"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#580c5205fd1516a5f508ab9cc39a7eb1">AddCallbackObject</a> (<a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *CallbackObject)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define the callback for message reception.  <a href="#580c5205fd1516a5f508ab9cc39a7eb1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#f22b8e86e1a4768b9f78a7fa2304b58d">RemoveCallbackObject</a> (<a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *CallbackObject)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the callback for message reception.  <a href="#f22b8e86e1a4768b9f78a7fa2304b58d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="905b3cbef239a3b84f2f3821bc5342fc"></a><!-- doxytag: member="Omiscid::Connector::RemoveAllCallbackObjects" ref="905b3cbef239a3b84f2f3821bc5342fc" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#905b3cbef239a3b84f2f3821bc5342fc">RemoveAllCallbackObjects</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove all callback object from this connector. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#67b4685ce5d5353016c79cceec1e8370">LinkToMsgManager</a> (<a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a> *msgManager)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set a <a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a> object as callback for message reception.  <a href="#67b4685ce5d5353016c79cceec1e8370"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9c441a2cd00e1760bf91e608e46732fa"></a><!-- doxytag: member="Omiscid::Connector::UnlinkFromMsgManager" ref="9c441a2cd00e1760bf91e608e46732fa" args="(MsgManager *msgManager)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#9c441a2cd00e1760bf91e608e46732fa">UnlinkFromMsgManager</a> (<a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a> *msgManager)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a <a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a> object as callback for message reception. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3f3a9c29d33511fb631d14a4a1294c30"></a><!-- doxytag: member="Omiscid::Connector::GetMaxMessageSizeForTCP" ref="3f3a9c29d33511fb631d14a4a1294c30" args="()" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#3f3a9c29d33511fb631d14a4a1294c30">GetMaxMessageSizeForTCP</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="123cbd3abc516f53768bc2b5139a5c05"></a><!-- doxytag: member="Omiscid::Connector::SetMaxMessageSizeForTCP" ref="123cbd3abc516f53768bc2b5139a5c05" args="(int max)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#123cbd3abc516f53768bc2b5139a5c05">SetMaxMessageSizeForTCP</a> (int max)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">size max for message on TCP Define the size max accepted for exchange on TCP (by default the value is 1&lt;&lt;16) <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#5723d5976e777a330a152ec8f13bbbe4">SetName</a> (const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a> NewName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#5e22460fe080d9818cb6dd3accc0a121">GetName</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_omiscid_1_1_com_tools.html">ComTools</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#a6c860f1ce5faf966e080fa657cfae40">Cast</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cast in <a class="el" href="class_omiscid_1_1_com_tools.html">ComTools</a>.  <a href="#a6c860f1ce5faf966e080fa657cfae40"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#c812dbd9cc446c38f95d3767a7b98dbc">AcceptConnection</a> (const <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> &amp;udp_connection, bool NewConnection)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Call on source of UDP message.  <a href="#c812dbd9cc446c38f95d3767a7b98dbc"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="077a6aa054853fe80fa6e0a8962a868d"></a><!-- doxytag: member="Omiscid::Connector::ProcessLyncSyncMsg" ref="077a6aa054853fe80fa6e0a8962a868d" args="(MsgSocketCallBackData *MsgData, MsgSocket *MyMsgSocket)" -->
static void FUNCTION_CALL_TYPE&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_connector.html#077a6aa054853fe80fa6e0a8962a868d">ProcessLyncSyncMsg</a> (<a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a> *MsgData, <a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a> *MyMsgSocket)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Group TCP and UDP communication means.
<p>
Manage connection as a server or can be connected as client. Communication can be done with TCP or UDP protocol.<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Sebastien Pesnel <p>
Dominique Vaufreydaz </dd></dl>

<p>

<p>
Definition at line <a class="el" href="_connector_8h-source.html#l00063">63</a> of file <a class="el" href="_connector_8h-source.html">Connector.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="19a1a94cd477e5c3dffc5fb26802b64e"></a><!-- doxytag: member="Omiscid::Connector::Connector" ref="19a1a94cd477e5c3dffc5fb26802b64e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Connector::Connector           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a_pid</em>&nbsp;</td><td>[in] the service identifier </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00023">23</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.<div class="fragment"><pre class="fragment"><a name="l00024"></a>00024 {
<a name="l00025"></a>00025     CallbackObject = NULL;
<a name="l00026"></a>00026     pid = 0;
<a name="l00027"></a>00027 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="d728d96ff5786432d5467ac728d70015"></a><!-- doxytag: member="Omiscid::Connector::Create" ref="d728d96ff5786432d5467ac728d70015" args="(int port_tcp=0, int port_udp=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Connector::Create           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port_tcp</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port_udp</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Run a <a class="el" href="class_omiscid_1_1_tcp_server.html">TcpServer</a>, an <a class="el" href="class_omiscid_1_1_udp_exchange.html">UdpExchange</a> object.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port_tcp</em>&nbsp;</td><td>[in] port where bind the TCP socket. if zero a free port is chosen, this port has the value returned by 'GetTcpPort'. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port_udp</em>&nbsp;</td><td>[in] port where bind the UDP socket. if zero a free port is chosen, this port has the value returned by 'GetUdpPort'. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00040">40</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_tcp_server_8cpp-source.html#l00036">Omiscid::TcpServer::Create()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00025">Omiscid::UdpExchange::Create()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00253">Omiscid::UdpExchange::GetUdpPort()</a>, <a class="el" href="_com_tools_8h-source.html#l00085">Omiscid::ComTools::MagicUdp</a>, <a class="el" href="_connector_8cpp-source.html#l00073">ProcessLyncSyncMsg()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00471">Omiscid::MsgSocket::SetCallbackSyncLink()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l00189">Omiscid::MsgSocket::SetSyncLinkData()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00124">Omiscid::Service::AddConnector()</a>.<div class="fragment"><pre class="fragment"><a name="l00041"></a>00041 {
<a name="l00042"></a>00042     <span class="comment">// REVIEW add support of UDP Port</span>
<a name="l00043"></a>00043     <a class="code" href="class_omiscid_1_1_udp_exchange.html#4258b0ae3dd5981b52fc37e7b3f8aa66">UdpExchange::Create</a>(port_udp);
<a name="l00044"></a>00044
<a name="l00045"></a>00045     <a class="code" href="class_omiscid_1_1_simple_string.html">SimpleString</a> tmps = <a class="code" href="class_omiscid_1_1_com_tools.html#42260102bf4ee94f245054967f26b910">MagicUdp</a>;
<a name="l00046"></a>00046     tmps +=     <span class="stringliteral">":"</span>;
<a name="l00047"></a>00047     tmps += <a class="code" href="class_omiscid_1_1_udp_exchange.html#772b4dc1ab355268312c590cfb433fe1">UdpExchange::GetUdpPort</a>();
<a name="l00048"></a>00048     <a class="code" href="class_omiscid_1_1_msg_socket.html#82d7f03e8a3acbfdd82bc35d3c1589f3">TcpServer::SetSyncLinkData</a>( tmps );
<a name="l00049"></a>00049     <a class="code" href="class_omiscid_1_1_msg_socket.html#dcae5a3be1bbfd31d4cbbe820d68a970">TcpServer::SetCallbackSyncLink</a>( <a class="code" href="class_omiscid_1_1_connector.html#077a6aa054853fe80fa6e0a8962a868d">ProcessLyncSyncMsg</a>, (<span class="keywordtype">void</span>*)<span class="keyword">this</span>, (<span class="keywordtype">void</span>*)0 );
<a name="l00050"></a>00050     <a class="code" href="class_omiscid_1_1_tcp_server.html#319287ed5b4e36cfdc8cf77dc0c0f822">TcpServer::Create</a>(port_tcp);
<a name="l00051"></a>00051 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="628c32df4212a5ba7c79dd2b48181313"></a><!-- doxytag: member="Omiscid::Connector::ConnectTo" ref="628c32df4212a5ba7c79dd2b48181313" args="(const SimpleString addr, int port_tcp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int Connector::ConnectTo           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port_tcp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Connection as client.
<p>
Create a Tcp Connection. If port_udp is not null, create an udp connection based on the tcp connection (for checking the validity of the connection). <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>[in] the address for the host to connect. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port_tcp</em>&nbsp;</td><td>[in] the number of the tcp port. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port_udp</em>&nbsp;</td><td>[in] the number of the udp port. Set this number to 0, if there is no udp connection. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the peer identifier. </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="class_omiscid_1_1_tcp_client.html#9baaeeeee0491dee6f420b83bf37a201">TcpClient::ConnectToServer</a> </dd></dl>

<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00118">118</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_msg_socket_8cpp-source.html#l00415">Omiscid::MsgSocket::AddCallbackObject()</a>, <a class="el" href="_msg_socket_8h-source.html#l00392">Omiscid::MsgSocket::CallbackObjects</a>, <a class="el" href="_tcp_client_8cpp-source.html#l00021">Omiscid::TcpClient::ConnectToServer()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00025">Omiscid::UdpExchange::Create()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00180">Omiscid::MsgSocket::GetName()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01479">Omiscid::MsgSocket::GetPeerPid()</a>, <a class="el" href="_connector_8cpp-source.html#l00619">GetServiceId()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00244">Omiscid::MsgSocket::GetSyncLinkData()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00253">Omiscid::UdpExchange::GetUdpPort()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01464">Omiscid::MsgSocket::IsConnected()</a>, <a class="el" href="_com_tools_8h-source.html#l00085">Omiscid::ComTools::MagicUdp</a>, <a class="el" href="_connector_8cpp-source.html#l00073">ProcessLyncSyncMsg()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00471">Omiscid::MsgSocket::SetCallbackSyncLink()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00175">Omiscid::MsgSocket::SetName()</a>, <a class="el" href="_tcp_client_8cpp-source.html#l00034">Omiscid::TcpClient::SetServiceId()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00189">Omiscid::MsgSocket::SetSyncLinkData()</a>, <a class="el" href="_lock_management_8cpp-source.html#l00075">Omiscid::SmartLocker::Unlock()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l01499">Omiscid::MsgSocket::WaitSyncLinkMsg()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00466">Omiscid::Service::ConnectTo()</a>.<div class="fragment"><pre class="fragment"><a name="l00119"></a>00119 {
<a name="l00120"></a>00120     <a class="code" href="class_omiscid_1_1_tcp_client.html">TcpClient</a>* tcpclient = <span class="keyword">new</span> OMISCID_TLM <a class="code" href="class_omiscid_1_1_tcp_client.html">TcpClient</a>();
<a name="l00121"></a>00121
<a name="l00122"></a>00122 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00123"></a>00123 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( tcpclient == (<a class="code" href="class_omiscid_1_1_tcp_client.html">TcpClient</a>*)NULL )
<a name="l00124"></a>00124     {
<a name="l00125"></a>00125         <span class="keywordflow">return</span> 0;
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 <span class="preprocessor">#endif</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span>
<a name="l00129"></a>00129     tcpclient-&gt;<a class="code" href="class_omiscid_1_1_tcp_client.html#63530c7269bc484f39cdda729bf4e8c3">SetServiceId</a>(<a class="code" href="class_omiscid_1_1_connector.html#7590581670e089568b99942dc2acd07b">GetServiceId</a>());
<a name="l00130"></a>00130     tcpclient-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#e23f86137b974c4b6aea0d07997a0bc3">SetName</a>(<a class="code" href="class_omiscid_1_1_msg_socket.html#b0c5b480cb6cfbe936453014348e203e">TcpServer::GetName</a>());
<a name="l00131"></a>00131     tcpclient-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#dcae5a3be1bbfd31d4cbbe820d68a970">SetCallbackSyncLink</a>( <a class="code" href="class_omiscid_1_1_connector.html#077a6aa054853fe80fa6e0a8962a868d">ProcessLyncSyncMsg</a>, (<span class="keywordtype">void</span>*)<span class="keyword">this</span>, (<span class="keywordtype">void</span>*)0 );
<a name="l00132"></a>00132
<a name="l00133"></a>00133     <span class="comment">// REVIEW : done by the TCP Port</span>
<a name="l00134"></a>00134     <span class="keywordflow">if</span> ( <a class="code" href="class_omiscid_1_1_udp_exchange.html#772b4dc1ab355268312c590cfb433fe1">UdpExchange::GetUdpPort</a>() == 0 )
<a name="l00135"></a>00135     {
<a name="l00136"></a>00136         <a class="code" href="class_omiscid_1_1_udp_exchange.html#4258b0ae3dd5981b52fc37e7b3f8aa66">UdpExchange::Create</a>(0);
<a name="l00137"></a>00137
<a name="l00138"></a>00138         <a class="code" href="class_omiscid_1_1_simple_string.html">SimpleString</a> tmps = <a class="code" href="class_omiscid_1_1_com_tools.html#42260102bf4ee94f245054967f26b910">MagicUdp</a>;
<a name="l00139"></a>00139         tmps += <span class="stringliteral">":"</span>;
<a name="l00140"></a>00140         tmps += <a class="code" href="class_omiscid_1_1_udp_exchange.html#772b4dc1ab355268312c590cfb433fe1">UdpExchange::GetUdpPort</a>();
<a name="l00141"></a>00141         <a class="code" href="class_omiscid_1_1_msg_socket.html#82d7f03e8a3acbfdd82bc35d3c1589f3">TcpServer::SetSyncLinkData</a>( tmps );
<a name="l00142"></a>00142         <a class="code" href="class_omiscid_1_1_msg_socket.html#dcae5a3be1bbfd31d4cbbe820d68a970">TcpServer::SetCallbackSyncLink</a>( <a class="code" href="class_omiscid_1_1_connector.html#077a6aa054853fe80fa6e0a8962a868d">ProcessLyncSyncMsg</a>, (<span class="keywordtype">void</span>*)<span class="keyword">this</span>, (<span class="keywordtype">void</span>*)0 );
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144
<a name="l00145"></a>00145     <span class="comment">// Set UDP Port as property for the Sync Link paquet of the TCP Connection</span>
<a name="l00146"></a>00146     tcpclient-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#82d7f03e8a3acbfdd82bc35d3c1589f3">SetSyncLinkData</a>( <a class="code" href="class_omiscid_1_1_msg_socket.html#506ead22a9cd791637fdf9b72c936fae">TcpServer::GetSyncLinkData</a>() );
<a name="l00147"></a>00147
<a name="l00148"></a>00148     <span class="comment">// the UDP connection will be filled later</span>
<a name="l00149"></a>00149     <a class="code" href="class_omiscid_1_1_client_connection.html">ClientConnection</a> * pConnection = <span class="keyword">new</span> OMISCID_TLM <a class="code" href="class_omiscid_1_1_client_connection.html">ClientConnection</a>( tcpclient, NULL );
<a name="l00150"></a>00150
<a name="l00151"></a>00151     <span class="comment">// add the client to my list of connected Socket</span>
<a name="l00152"></a>00152     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00153"></a>00153     ListClients.Add(pConnection);
<a name="l00154"></a>00154     SL_ListClients.Unlock();
<a name="l00155"></a>00155
<a name="l00156"></a>00156     tcpclient-&gt;<a class="code" href="class_omiscid_1_1_tcp_client.html#9baaeeeee0491dee6f420b83bf37a201">ConnectToServer</a>(addr, port_tcp);
<a name="l00157"></a>00157
<a name="l00158"></a>00158     <span class="comment">// REVIEW</span>
<a name="l00159"></a>00159     <span class="comment">// tcpclient-&gt;SendSyncLinkMsg(); =&gt; done in ConnectToServer</span>
<a name="l00160"></a>00160     <span class="comment">// if ( tcpclient-&gt;WaitSyncLinkMsg() == false )</span>
<a name="l00161"></a>00161     <span class="comment">//{</span>
<a name="l00162"></a>00162         <span class="comment">// We do not manadge to</span>
<a name="l00163"></a>00163     <span class="comment">//  TraceError( "Could not initialise connection in time, default mode is TCP until initialisation is done.\n" );</span>
<a name="l00164"></a>00164     <span class="comment">//}</span>
<a name="l00165"></a>00165
<a name="l00166"></a>00166     <span class="comment">// Copy my callback objects to the new connection</span>
<a name="l00167"></a>00167     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_TcpServer_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">TcpServer::CallbackObjects</a>);
<a name="l00168"></a>00168     <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">TcpServer::CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">TcpServer::CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">TcpServer::CallbackObjects</a>.Next() )
<a name="l00169"></a>00169     {
<a name="l00170"></a>00170         tcpclient-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#e6a4e463d7f2b49842a19ef632607b91">AddCallbackObject</a>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">TcpServer::CallbackObjects</a>.GetCurrent() );
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172     SL_TcpServer_CallbackObjects.Unlock();
<a name="l00173"></a>00173
<a name="l00174"></a>00174     <span class="keywordflow">while</span>( tcpclient-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#21e5b5ec66ef490dec3d957711b91c90">IsConnected</a>() )
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176         <span class="keywordflow">if</span> ( tcpclient-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#7d87ebb3ed18bb10f3074e2730feb9e6">WaitSyncLinkMsg</a>(30) == true )
<a name="l00177"></a>00177         {
<a name="l00178"></a>00178             <span class="keywordflow">break</span>;
<a name="l00179"></a>00179         }
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181
<a name="l00182"></a>00182     <span class="keywordflow">return</span> tcpclient-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#3426f728c7e5b7e37376dc9ccc0f4d42">GetPeerPid</a>();
<a name="l00183"></a>00183 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fec46fd4941842058199a8b15ad6b948"></a><!-- doxytag: member="Omiscid::Connector::SendToAll" ref="fec46fd4941842058199a8b15ad6b948" args="(int len, const char *buf, bool fastsend=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Connector::SendToAll           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>fastsend</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message on all the existing connection.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>[in] the length of the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>[in] the buffer that contains the message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fastsend</em>&nbsp;</td><td>[in] if true unsafe UDP connection may be used, it is this connection where the data are sent. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00214">214</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_simple_exception_8h-source.html#l00063">Omiscid::SimpleException::err</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00156">Omiscid::UdpExchange::FindConnectionFromId()</a>, <a class="el" href="_simple_string_8cpp-source.html#l00897">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01464">Omiscid::MsgSocket::IsConnected()</a>, <a class="el" href="_tcp_server_8h-source.html#l00179">Omiscid::TcpServer::listConnections</a>, <a class="el" href="_udp_exchange_8h-source.html#l00148">Omiscid::UdpExchange::listUdpConnections</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, <a class="el" href="_config_system_8h-source.html#l00234">Omiscid::OmiscidTrace()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00209">Omiscid::UdpExchange::RemoveConnectionWithId()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00049">Omiscid::UdpExchange::SendTo()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00105">Omiscid::TcpServer::SendToAllClients()</a>, <a class="el" href="_socket_8h-source.html#l00020">UDP_MAX_MSG_SIZE</a>, <a class="el" href="_msg_socket_8h-source.html#l00507">Omiscid::MsgSocket::udpConnection</a>, and <a class="el" href="_lock_management_8cpp-source.html#l00075">Omiscid::SmartLocker::Unlock()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00182">Omiscid::Service::SendToAllClients()</a>.<div class="fragment"><pre class="fragment"><a name="l00215"></a>00215 {
<a name="l00216"></a>00216     <span class="comment">// OmiscidTrace( "in SerndToAll\n");</span>
<a name="l00217"></a>00217     <span class="keywordflow">if</span> ( fastsend &amp;&amp; len &gt; <a class="code" href="_socket_8h.html#ab35bfe248d0a277ab80183fcf9c8aa4">UDP_MAX_MSG_SIZE</a> )
<a name="l00218"></a>00218     {
<a name="l00219"></a>00219         fastsend = <span class="keyword">false</span>;
<a name="l00220"></a>00220     }
<a name="l00221"></a>00221
<a name="l00222"></a>00222     <span class="keywordflow">if</span>( !fastsend )
<a name="l00223"></a>00223     {
<a name="l00224"></a>00224         <span class="comment">//send to all client of server</span>
<a name="l00225"></a>00225         <a class="code" href="class_omiscid_1_1_tcp_server.html#c8626847c8c147546061b209d1f1a6c7">TcpServer::SendToAllClients</a>(len, buf);
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227     <span class="keywordflow">else</span>
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229         <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_TcpServer_listConnections(<a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>);
<a name="l00230"></a>00230         <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_UdpExchange_listUdpConnections(<a class="code" href="class_omiscid_1_1_udp_exchange.html#08383e43746e1b5184e6f7e39fedf3bc">UdpExchange::listUdpConnections</a>);
<a name="l00231"></a>00231         <span class="keywordflow">try</span>
<a name="l00232"></a>00232         {
<a name="l00233"></a>00233             <span class="keywordflow">for</span>(<a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.First();  <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.NotAtEnd();
<a name="l00234"></a>00234                 <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.Next())
<a name="l00235"></a>00235             {
<a name="l00236"></a>00236                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tcp_pid = (<a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.GetCurrent())-&gt;GetPeerPid();
<a name="l00237"></a>00237
<a name="l00238"></a>00238                 <span class="keywordflow">if</span>(!(<a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.GetCurrent())-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#21e5b5ec66ef490dec3d957711b91c90">IsConnected</a>())
<a name="l00239"></a>00239                 {
<a name="l00240"></a>00240                     <span class="keyword">delete</span> <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.GetCurrent();
<a name="l00241"></a>00241                     <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.RemoveCurrent();
<a name="l00242"></a>00242
<a name="l00243"></a>00243                     <a class="code" href="class_omiscid_1_1_udp_exchange.html#1f8cbb08e7960ae5d640583dcb0a46cc">UdpExchange::RemoveConnectionWithId</a>(tcp_pid);
<a name="l00244"></a>00244                 }
<a name="l00245"></a>00245                 <span class="keywordflow">else</span>
<a name="l00246"></a>00246                 {
<a name="l00247"></a>00247                     <a class="code" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a>* udp_found =  <a class="code" href="class_omiscid_1_1_udp_exchange.html#f24431f24cb168b9e2a5772fed587a4d">UdpExchange::FindConnectionFromId</a>(tcp_pid);
<a name="l00248"></a>00248                     <span class="keywordflow">if</span> (udp_found)
<a name="l00249"></a>00249                     {
<a name="l00250"></a>00250                         <a class="code" href="class_omiscid_1_1_udp_exchange.html#63a0ea64923a0d80db8216ae044fefdc">UdpExchange::SendTo</a>(len, buf, udp_found);
<a name="l00251"></a>00251                     }
<a name="l00252"></a>00252                     <span class="keywordflow">else</span>
<a name="l00253"></a>00253                     {
<a name="l00254"></a>00254                         <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.GetCurrent()-&gt;Send(len, buf);
<a name="l00255"></a>00255                     }
<a name="l00256"></a>00256                 }
<a name="l00257"></a>00257             }
<a name="l00258"></a>00258         } <span class="keywordflow">catch</span>(...) {
<a name="l00259"></a>00259         }
<a name="l00260"></a>00260
<a name="l00261"></a>00261         SL_UdpExchange_listUdpConnections.Unlock();
<a name="l00262"></a>00262         SL_TcpServer_listConnections.Unlock();
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264
<a name="l00265"></a>00265     <span class="comment">// send to all server where it is connected</span>
<a name="l00266"></a>00266     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00267"></a>00267     <span class="keywordflow">for</span>(ListClients.First(); ListClients.NotAtEnd(); ListClients.Next())
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269         <span class="keywordflow">if</span>((ListClients.GetCurrent())-&gt;tcpClient-&gt;IsConnected())
<a name="l00270"></a>00270         {
<a name="l00271"></a>00271             <span class="keywordflow">try</span>
<a name="l00272"></a>00272             {
<a name="l00273"></a>00273                 <span class="keywordflow">if</span>( fastsend &amp;&amp; (ListClients.GetCurrent())-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#8ef83dfae782b01709b496d2e6901ff2">udpConnection</a> )
<a name="l00274"></a>00274                 {
<a name="l00275"></a>00275                     <a class="code" href="class_omiscid_1_1_udp_exchange.html#63a0ea64923a0d80db8216ae044fefdc">UdpExchange::SendTo</a>(len, buf, (ListClients.GetCurrent())-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#8ef83dfae782b01709b496d2e6901ff2">udpConnection</a>);
<a name="l00276"></a>00276                 }
<a name="l00277"></a>00277                 <span class="keywordflow">else</span>
<a name="l00278"></a>00278                 {
<a name="l00279"></a>00279                     ListClients.GetCurrent()-&gt;tcpClient-&gt;SendToServer(len, buf);
<a name="l00280"></a>00280                 }
<a name="l00281"></a>00281             }
<a name="l00282"></a>00282             <span class="keywordflow">catch</span>( <a class="code" href="class_omiscid_1_1_socket_exception.html">SocketException</a> &amp;e )
<a name="l00283"></a>00283             {
<a name="l00284"></a>00284                 <a class="code" href="namespace_omiscid.html#75386ddb9b14af103045f0df7c2b2429">OmiscidTrace</a>( <span class="stringliteral">"Error while sending to all peers : %s (%d)\n"</span>, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#073b80f513204da691abc6b2f9b03338">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#25a4d280190281495a5f85fa4dca1319">err</a> );
<a name="l00285"></a>00285             }
<a name="l00286"></a>00286         }
<a name="l00287"></a>00287         <span class="keywordflow">else</span>
<a name="l00288"></a>00288         {
<a name="l00289"></a>00289             <span class="keyword">delete</span> ListClients.GetCurrent();
<a name="l00290"></a>00290             ListClients.RemoveCurrent();
<a name="l00291"></a>00291         }
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293     <span class="comment">// OmiscidTrace( "out SendToAll\n");</span>
<a name="l00294"></a>00294 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="79ee5193ac9a4f25ca2fa53de9128e5c"></a><!-- doxytag: member="Omiscid::Connector::SendToPeer" ref="79ee5193ac9a4f25ca2fa53de9128e5c" args="(int len, const char *buf, unsigned int pid, bool fastsend=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Connector::SendToPeer           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>fastsend</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message to a particular client define par its identifier.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>[in] the length of the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>[in] the buffer that contains the message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pid</em>&nbsp;</td><td>[in] the identifier of the destination peer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fastsend</em>&nbsp;</td><td>[in] if true unsafe UDP connection may be used, it is this connection where the data are sent. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of byte sent. </dd></dl>

<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00296">296</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_simple_exception_8h-source.html#l00063">Omiscid::SimpleException::err</a>, <a class="el" href="_simple_string_8cpp-source.html#l00897">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, <a class="el" href="_config_system_8h-source.html#l00234">Omiscid::OmiscidTrace()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00049">Omiscid::UdpExchange::SendTo()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00059">Omiscid::TcpServer::SendToClient()</a>, <a class="el" href="_tcp_client_8cpp-source.html#l00029">Omiscid::TcpClient::SendToServer()</a>, <a class="el" href="_config_system_8h-source.html#l00145">SOCKET_ERROR</a>, <a class="el" href="_connector_8h-source.html#l00049">Omiscid::ClientConnection::tcpClient</a>, <a class="el" href="_socket_8h-source.html#l00020">UDP_MAX_MSG_SIZE</a>, <a class="el" href="_connector_8h-source.html#l00050">Omiscid::ClientConnection::udpConnection</a>, and <a class="el" href="_lock_management_8cpp-source.html#l00075">Omiscid::SmartLocker::Unlock()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00220">Omiscid::Service::SendToOneClient()</a>.<div class="fragment"><pre class="fragment"><a name="l00297"></a>00297 {
<a name="l00298"></a>00298     <span class="keywordtype">int</span> ret = <a class="code" href="group___system.html#g633b0396ff93d336a088412a190a5072">SOCKET_ERROR</a>;
<a name="l00299"></a>00299
<a name="l00300"></a>00300     <span class="comment">// If we can not send it fast, let's send is slower</span>
<a name="l00301"></a>00301     <span class="keywordflow">if</span> ( fastsend &amp;&amp; len &gt; <a class="code" href="_socket_8h.html#ab35bfe248d0a277ab80183fcf9c8aa4">UDP_MAX_MSG_SIZE</a> )
<a name="l00302"></a>00302     {
<a name="l00303"></a>00303         fastsend = <span class="keyword">false</span>;
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305
<a name="l00306"></a>00306     <span class="comment">// Search between my client connections</span>
<a name="l00307"></a>00307     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00308"></a>00308
<a name="l00309"></a>00309     <a class="code" href="class_omiscid_1_1_client_connection.html">ClientConnection</a>* cc = FindClientConnectionFromId(pid);
<a name="l00310"></a>00310     <span class="keywordflow">if</span> ( cc )
<a name="l00311"></a>00311     {
<a name="l00312"></a>00312         <span class="keywordflow">try</span>
<a name="l00313"></a>00313         {
<a name="l00314"></a>00314             <span class="keywordflow">if</span> ( fastsend &amp;&amp; cc-&gt;<a class="code" href="class_omiscid_1_1_client_connection.html#92fc1a1e6b6776c30b5a54934ec97379">udpConnection</a> )
<a name="l00315"></a>00315             {
<a name="l00316"></a>00316                 ret = <a class="code" href="class_omiscid_1_1_udp_exchange.html#63a0ea64923a0d80db8216ae044fefdc">UdpExchange::SendTo</a>(len, buf, cc-&gt;<a class="code" href="class_omiscid_1_1_client_connection.html#92fc1a1e6b6776c30b5a54934ec97379">udpConnection</a>);
<a name="l00317"></a>00317             }
<a name="l00318"></a>00318             <span class="keywordflow">else</span>
<a name="l00319"></a>00319             {
<a name="l00320"></a>00320                 ret = cc-&gt;<a class="code" href="class_omiscid_1_1_client_connection.html#62d9b42b5f5cceb75290ba8a5956f607">tcpClient</a>-&gt;<a class="code" href="class_omiscid_1_1_tcp_client.html#ae2d9d7688bdd0854edb43bf7b7dc3c0">SendToServer</a>(len, buf);
<a name="l00321"></a>00321             }
<a name="l00322"></a>00322         }
<a name="l00323"></a>00323         <span class="keywordflow">catch</span>( <a class="code" href="class_omiscid_1_1_socket_exception.html">SocketException</a> &amp;e )
<a name="l00324"></a>00324         {
<a name="l00325"></a>00325             <a class="code" href="namespace_omiscid.html#75386ddb9b14af103045f0df7c2b2429">OmiscidTrace</a>( <span class="stringliteral">"Error while sending to peer %8.8x : %s (%d)\n"</span>, pid, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#073b80f513204da691abc6b2f9b03338">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#25a4d280190281495a5f85fa4dca1319">err</a> );
<a name="l00326"></a>00326         }
<a name="l00327"></a>00327         <span class="keywordflow">return</span> ret;
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329     SL_ListClients.Unlock();
<a name="l00330"></a>00330
<a name="l00331"></a>00331     <span class="comment">//recherche sur les connexions au serveur</span>
<a name="l00332"></a>00332     <span class="keywordflow">if</span>( fastsend ) <span class="comment">//recherche dans les connexion su serveur udp</span>
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334         ret = <a class="code" href="class_omiscid_1_1_udp_exchange.html#63a0ea64923a0d80db8216ae044fefdc">UdpExchange::SendTo</a>(len, buf, pid);
<a name="l00335"></a>00335         <span class="keywordflow">if</span> ( ret &gt; 0 )
<a name="l00336"></a>00336         {
<a name="l00337"></a>00337             <span class="keywordflow">return</span> ret;
<a name="l00338"></a>00338         }
<a name="l00339"></a>00339     }
<a name="l00340"></a>00340
<a name="l00341"></a>00341     <span class="comment">//recherche dans les connexion su serveur tcp</span>
<a name="l00342"></a>00342     ret = <a class="code" href="class_omiscid_1_1_tcp_server.html#55541631515a196a876d1e31b5d3e957">TcpServer::SendToClient</a>(len, buf, pid);
<a name="l00343"></a>00343     <span class="keywordflow">if</span> ( ret &gt; 0 )
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345         <span class="keywordflow">return</span> ret;
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347     <span class="keywordflow">return</span> <a class="code" href="group___system.html#g633b0396ff93d336a088412a190a5072">SOCKET_ERROR</a>;
<a name="l00348"></a>00348 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f08cf8ae1470bc37400406a97938feb5"></a><!-- doxytag: member="Omiscid::Connector::SetServiceId" ref="f08cf8ae1470bc37400406a97938feb5" args="(unsigned int pid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Connector::SetServiceId           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>pid</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Define the service identifier associated to this object.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pid</em>&nbsp;</td><td>[in] a service id </td></tr>
  </table>
</dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_tcp_server.html#6843802ccb0192190d48ebb5b3a2efb8">Omiscid::TcpServer</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00185">185</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_udp_exchange_8cpp-source.html#l00225">Omiscid::UdpExchange::SetServiceId()</a>, and <a class="el" href="_tcp_server_8cpp-source.html#l00429">Omiscid::TcpServer::SetServiceId()</a>.<div class="fragment"><pre class="fragment"><a name="l00186"></a>00186 {
<a name="l00187"></a>00187     <span class="comment">// Check validity of a service Id</span>
<a name="l00188"></a>00188     <span class="keywordflow">if</span> ( (pid &amp; ComTools::CONNECTOR_ID) == 0 )
<a name="l00189"></a>00189     {
<a name="l00190"></a>00190         <span class="comment">// pid = pid | 0xffffff01;</span>
<a name="l00191"></a>00191 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00192"></a>00192 <span class="preprocessor"></span>        <span class="comment">//              fprintf( stderr, "Warning: ConnectorId could not be 0 for Connector. Value changes to 1 (PeerId = %8.8x)\n", pid );</span>
<a name="l00193"></a>00193 <span class="preprocessor">#endif</span>
<a name="l00194"></a>00194 <span class="preprocessor"></span>    }
<a name="l00195"></a>00195
<a name="l00196"></a>00196     <a class="code" href="class_omiscid_1_1_tcp_server.html#6843802ccb0192190d48ebb5b3a2efb8">TcpServer::SetServiceId</a>(pid);
<a name="l00197"></a>00197     <a class="code" href="class_omiscid_1_1_udp_exchange.html#0eef33ee246d7dd66736ceb9552e92f4">UdpExchange::SetServiceId</a>(pid);
<a name="l00198"></a>00198
<a name="l00199"></a>00199     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00200"></a>00200     <span class="keywordflow">for</span>( ListClients.First(); ListClients.NotAtEnd();  ListClients.Next())
<a name="l00201"></a>00201     {
<a name="l00202"></a>00202         <span class="keywordflow">if</span>((ListClients.GetCurrent())-&gt;tcpClient-&gt;IsConnected())
<a name="l00203"></a>00203         {
<a name="l00204"></a>00204             (ListClients.GetCurrent())-&gt;tcpClient-&gt;SetServiceId(pid);
<a name="l00205"></a>00205         }
<a name="l00206"></a>00206         <span class="keywordflow">else</span>
<a name="l00207"></a>00207         {
<a name="l00208"></a>00208             <span class="keyword">delete</span> ListClients.GetCurrent();
<a name="l00209"></a>00209             ListClients.RemoveCurrent();
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7590581670e089568b99942dc2acd07b"></a><!-- doxytag: member="Omiscid::Connector::GetServiceId" ref="7590581670e089568b99942dc2acd07b" args="() const" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int Connector::GetServiceId           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the service id.
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the service identifier associated to this object </dd></dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_tcp_server.html#aa8162daf6602a0611e631a5496a9c05">Omiscid::TcpServer</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00619">619</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_tcp_server_8cpp-source.html#l00567">Omiscid::TcpServer::GetServiceId()</a>.
<p>
Referenced by <a class="el" href="_connector_8cpp-source.html#l00118">ConnectTo()</a>.<div class="fragment"><pre class="fragment"><a name="l00620"></a>00620 {
<a name="l00621"></a>00621     <span class="keywordflow">return</span> <a class="code" href="class_omiscid_1_1_tcp_server.html#aa8162daf6602a0611e631a5496a9c05">TcpServer::GetServiceId</a>();
<a name="l00622"></a>00622 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d7f28167c7115cf3b147c2b494fb9ece"></a><!-- doxytag: member="Omiscid::Connector::GetTcpPort" ref="d7f28167c7115cf3b147c2b494fb9ece" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short Connector::GetTcpPort           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the TCP port.
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the port number of the TCP connection created as server </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="class_omiscid_1_1_connector.html#d728d96ff5786432d5467ac728d70015">Create</a> </dd></dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_tcp_server.html#c6a92b461be318d0509e0936c51ade6d">Omiscid::TcpServer</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00614">614</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_tcp_server_8cpp-source.html#l00572">Omiscid::TcpServer::GetTcpPort()</a>.<div class="fragment"><pre class="fragment"><a name="l00615"></a>00615 {
<a name="l00616"></a>00616     <span class="keywordflow">return</span> <a class="code" href="class_omiscid_1_1_tcp_server.html#c6a92b461be318d0509e0936c51ade6d">TcpServer::GetTcpPort</a>();
<a name="l00617"></a>00617 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7124a1ec2a8829463729d201c08391cb"></a><!-- doxytag: member="Omiscid::Connector::GetUdpPort" ref="7124a1ec2a8829463729d201c08391cb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short Connector::GetUdpPort           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the TCP port.
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the port number of the UDP connection created </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="class_omiscid_1_1_connector.html#d728d96ff5786432d5467ac728d70015">Create</a> </dd></dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_udp_exchange.html#772b4dc1ab355268312c590cfb433fe1">Omiscid::UdpExchange</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00609">609</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_udp_exchange_8cpp-source.html#l00253">Omiscid::UdpExchange::GetUdpPort()</a>.
<p>
Referenced by <a class="el" href="_connector_8cpp-source.html#l00073">ProcessLyncSyncMsg()</a>.<div class="fragment"><pre class="fragment"><a name="l00610"></a>00610 {
<a name="l00611"></a>00611     <span class="keywordflow">return</span> <a class="code" href="class_omiscid_1_1_udp_exchange.html#772b4dc1ab355268312c590cfb433fe1">UdpExchange::GetUdpPort</a>();
<a name="l00612"></a>00612 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c3844c72f8a2dde74236a89345510398"></a><!-- doxytag: member="Omiscid::Connector::GetNbConnection" ref="c3844c72f8a2dde74236a89345510398" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Connector::GetNbConnection           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the number of connections.
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of current connections </dd></dl>

<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00516">516</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_tcp_server_8cpp-source.html#l00262">Omiscid::TcpServer::GetNbConnections()</a>.<div class="fragment"><pre class="fragment"><a name="l00517"></a>00517 {
<a name="l00518"></a>00518     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00519"></a>00519     <span class="keywordflow">for</span>(ListClients.First(); ListClients.NotAtEnd(); ListClients.Next())
<a name="l00520"></a>00520     {
<a name="l00521"></a>00521         <span class="keywordflow">if</span>( ListClients.GetCurrent()-&gt;tcpClient-&gt;IsConnected() == false )
<a name="l00522"></a>00522         {
<a name="l00523"></a>00523             <span class="keyword">delete</span> ListClients.GetCurrent();
<a name="l00524"></a>00524             ListClients.RemoveCurrent();
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526     }
<a name="l00527"></a>00527     <span class="keywordtype">int</span> nb = (int)(ListClients.GetNumberOfElements() + <a class="code" href="class_omiscid_1_1_tcp_server.html#826ff4bb9524d87d88893cd3740f1c83">TcpServer::GetNbConnections</a>());
<a name="l00528"></a>00528
<a name="l00529"></a>00529     <span class="keywordflow">return</span> nb;
<a name="l00530"></a>00530 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="12d389fb6bcee1d43ae4ef20c57a1549"></a><!-- doxytag: member="Omiscid::Connector::GetListPeerId" ref="12d389fb6bcee1d43ae4ef20c57a1549" args="(SimpleList&lt; unsigned int &gt; &amp;listId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Connector::GetListPeerId           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_simple_list.html">SimpleList</a>&lt; unsigned int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>listId</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
List of peer id for all the connections.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>listId</em>&nbsp;</td><td>[in, out] add to the end of this list the peer id of each connection </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of id added </dd></dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_tcp_server.html#9a6dfaf0c6a8e7348c8c7d96da133d56">Omiscid::TcpServer</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00532">532</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_simple_list_8h-source.html#l00218">Omiscid::SimpleList&lt; TYPE &gt;::Add()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00406">Omiscid::TcpServer::GetListPeerId()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l01479">Omiscid::MsgSocket::GetPeerPid()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00705">Omiscid::Service::CloseAllConnections()</a>.<div class="fragment"><pre class="fragment"><a name="l00533"></a>00533 {
<a name="l00534"></a>00534     <span class="keywordtype">int</span> nb = <a class="code" href="class_omiscid_1_1_tcp_server.html#9a6dfaf0c6a8e7348c8c7d96da133d56">TcpServer::GetListPeerId</a>(listId);
<a name="l00535"></a>00535
<a name="l00536"></a>00536     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00537"></a>00537     <span class="keywordflow">for</span>(ListClients.First(); ListClients.NotAtEnd(); ListClients.Next())
<a name="l00538"></a>00538     {
<a name="l00539"></a>00539         <span class="keywordflow">if</span>((ListClients.GetCurrent())-&gt;tcpClient-&gt;IsConnected())
<a name="l00540"></a>00540         {
<a name="l00541"></a>00541             listId.<a class="code" href="class_omiscid_1_1_simple_list.html#4504f0e0f3fb158d00b90c714d947bb6">Add</a>((ListClients.GetCurrent())-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#3426f728c7e5b7e37376dc9ccc0f4d42">GetPeerPid</a>());
<a name="l00542"></a>00542             nb++;
<a name="l00543"></a>00543         }
<a name="l00544"></a>00544         <span class="keywordflow">else</span>
<a name="l00545"></a>00545         {
<a name="l00546"></a>00546             <span class="keyword">delete</span> ListClients.GetCurrent();
<a name="l00547"></a>00547             ListClients.RemoveCurrent();
<a name="l00548"></a>00548         }
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550
<a name="l00551"></a>00551     <span class="keywordflow">return</span> nb;
<a name="l00552"></a>00552 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="580c5205fd1516a5f508ab9cc39a7eb1"></a><!-- doxytag: member="Omiscid::Connector::AddCallbackObject" ref="580c5205fd1516a5f508ab9cc39a7eb1" args="(MsgSocketCallbackObject *CallbackObject)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Connector::AddCallbackObject           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *&nbsp;</td>
          <td class="paramname"> <em>CallbackObject</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Define the callback for message reception.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CallbackObject</em>&nbsp;</td><td>the object that will be used as callback </td></tr>
  </table>
</dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_tcp_server.html#d1c7a4f33733a8a33c7580d2f96ac1d4">Omiscid::TcpServer</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00350">350</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_msg_socket_8cpp-source.html#l00415">Omiscid::MsgSocket::AddCallbackObject()</a>, and <a class="el" href="_tcp_server_8cpp-source.html#l00330">Omiscid::TcpServer::AddCallbackObject()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00580">Omiscid::Service::AddConnectorListener()</a>, and <a class="el" href="_connector_8cpp-source.html#l00624">LinkToMsgManager()</a>.<div class="fragment"><pre class="fragment"><a name="l00351"></a>00351 {
<a name="l00352"></a>00352     <span class="comment">//printf("Connector::SetCallBackOnRecv\n");</span>
<a name="l00353"></a>00353
<a name="l00354"></a>00354     <span class="keywordflow">if</span> ( <a class="code" href="class_omiscid_1_1_tcp_server.html#d1c7a4f33733a8a33c7580d2f96ac1d4">TcpServer::AddCallbackObject</a>(CallbackObject) == <span class="keyword">false</span> )
<a name="l00355"></a>00355     {
<a name="l00356"></a>00356         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358
<a name="l00359"></a>00359     <a class="code" href="class_omiscid_1_1_msg_socket.html#e6a4e463d7f2b49842a19ef632607b91">UdpExchange::AddCallbackObject</a>(CallbackObject);
<a name="l00360"></a>00360
<a name="l00361"></a>00361     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00362"></a>00362     <span class="keywordflow">for</span>(ListClients.First(); ListClients.NotAtEnd(); ListClients.Next())
<a name="l00363"></a>00363     {
<a name="l00364"></a>00364         <span class="keywordflow">if</span>((ListClients.GetCurrent())-&gt;tcpClient-&gt;IsConnected())
<a name="l00365"></a>00365         {
<a name="l00366"></a>00366             (ListClients.GetCurrent())-&gt;tcpClient-&gt;AddCallbackObject(CallbackObject);
<a name="l00367"></a>00367         }
<a name="l00368"></a>00368         <span class="keywordflow">else</span>
<a name="l00369"></a>00369         {
<a name="l00370"></a>00370             <span class="keyword">delete</span> ListClients.GetCurrent();
<a name="l00371"></a>00371             ListClients.RemoveCurrent();
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374
<a name="l00375"></a>00375     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00376"></a>00376 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f22b8e86e1a4768b9f78a7fa2304b58d"></a><!-- doxytag: member="Omiscid::Connector::RemoveCallbackObject" ref="f22b8e86e1a4768b9f78a7fa2304b58d" args="(MsgSocketCallbackObject *CallbackObject)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Connector::RemoveCallbackObject           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *&nbsp;</td>
          <td class="paramname"> <em>CallbackObject</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retrieve the callback for message reception.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CallbackObject</em>&nbsp;</td><td>the callback object to remove </td></tr>
  </table>
</dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_tcp_server.html#4e34be9756270406e5cad5ef1e6c988f">Omiscid::TcpServer</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00378">378</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_msg_socket_8cpp-source.html#l00440">Omiscid::MsgSocket::RemoveCallbackObject()</a>, and <a class="el" href="_tcp_server_8cpp-source.html#l00356">Omiscid::TcpServer::RemoveCallbackObject()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00608">Omiscid::Service::RemoveConnectorListener()</a>, and <a class="el" href="_connector_8cpp-source.html#l00629">UnlinkFromMsgManager()</a>.<div class="fragment"><pre class="fragment"><a name="l00379"></a>00379 {
<a name="l00380"></a>00380     <span class="comment">//printf("Connector::SetCallBackOnRecv\n");</span>
<a name="l00381"></a>00381
<a name="l00382"></a>00382     <span class="keywordflow">if</span> ( <a class="code" href="class_omiscid_1_1_tcp_server.html#4e34be9756270406e5cad5ef1e6c988f">TcpServer::RemoveCallbackObject</a>(CallbackObject) == <span class="keyword">false</span> )
<a name="l00383"></a>00383     {
<a name="l00384"></a>00384         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386
<a name="l00387"></a>00387     <a class="code" href="class_omiscid_1_1_msg_socket.html#749006fded14bc52f629ffa9cccdacf8">UdpExchange::RemoveCallbackObject</a>(CallbackObject);
<a name="l00388"></a>00388
<a name="l00389"></a>00389     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00390"></a>00390     <span class="keywordflow">for</span>(ListClients.First(); ListClients.NotAtEnd(); ListClients.Next())
<a name="l00391"></a>00391     {
<a name="l00392"></a>00392         <span class="keywordflow">if</span>( ListClients.GetCurrent()-&gt;tcpClient-&gt;IsConnected() == true )
<a name="l00393"></a>00393         {
<a name="l00394"></a>00394             (ListClients.GetCurrent())-&gt;tcpClient-&gt;RemoveCallbackObject(CallbackObject);
<a name="l00395"></a>00395         }
<a name="l00396"></a>00396         <span class="keywordflow">else</span>
<a name="l00397"></a>00397         {
<a name="l00398"></a>00398             <span class="keyword">delete</span> ListClients.GetCurrent();
<a name="l00399"></a>00399             ListClients.RemoveCurrent();
<a name="l00400"></a>00400         }
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402
<a name="l00403"></a>00403     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00404"></a>00404 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="67b4685ce5d5353016c79cceec1e8370"></a><!-- doxytag: member="Omiscid::Connector::LinkToMsgManager" ref="67b4685ce5d5353016c79cceec1e8370" args="(MsgManager *msgManager)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Connector::LinkToMsgManager           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a> *&nbsp;</td>
          <td class="paramname"> <em>msgManager</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a <a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a> object as callback for message reception.
<p>
Enable to define a <a class="el" href="class_omiscid_1_1_msg_manager.html">MsgManager</a> object for the callback function of the receive method. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msgManager</em>&nbsp;</td><td>[in, out] object where the message are sent when they arrive. </td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd>SetCallBackOnRecv </dd></dl>

<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00624">624</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_connector_8cpp-source.html#l00350">AddCallbackObject()</a>.<div class="fragment"><pre class="fragment"><a name="l00625"></a>00625 {
<a name="l00626"></a>00626     <span class="keywordflow">return</span> <a class="code" href="class_omiscid_1_1_connector.html#580c5205fd1516a5f508ab9cc39a7eb1">AddCallbackObject</a>(msgManager);
<a name="l00627"></a>00627 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5723d5976e777a330a152ec8f13bbbe4"></a><!-- doxytag: member="Omiscid::Connector::SetName" ref="5723d5976e777a330a152ec8f13bbbe4" args="(const SimpleString NewName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Connector::SetName           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a>&nbsp;</td>
          <td class="paramname"> <em>NewName</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Used to set names on <a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a>
<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_msg_socket.html#e23f86137b974c4b6aea0d07997a0bc3">Omiscid::MsgSocket</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00053">53</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_msg_socket_8cpp-source.html#l00175">Omiscid::MsgSocket::SetName()</a>.
<p>
Referenced by <a class="el" href="_service_8cpp-source.html#l00124">Omiscid::Service::AddConnector()</a>.<div class="fragment"><pre class="fragment"><a name="l00054"></a>00054 {
<a name="l00055"></a>00055     <span class="comment">// Change to all my views...</span>
<a name="l00056"></a>00056     <a class="code" href="class_omiscid_1_1_msg_socket.html#e23f86137b974c4b6aea0d07997a0bc3">TcpServer::SetName</a>(NewName);
<a name="l00057"></a>00057     <a class="code" href="class_omiscid_1_1_msg_socket.html#e23f86137b974c4b6aea0d07997a0bc3">UdpExchange::SetName</a>(NewName);
<a name="l00058"></a>00058
<a name="l00059"></a>00059     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00060"></a>00060
<a name="l00061"></a>00061     <span class="keywordflow">for</span>(ListClients.First(); ListClients.NotAtEnd(); ListClients.Next())
<a name="l00062"></a>00062     {
<a name="l00063"></a>00063         ListClients.GetCurrent()-&gt;tcpClient-&gt;SetName(NewName);
<a name="l00064"></a>00064     }
<a name="l00065"></a>00065 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5e22460fe080d9818cb6dd3accc0a121"></a><!-- doxytag: member="Omiscid::Connector::GetName" ref="5e22460fe080d9818cb6dd3accc0a121" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a> Connector::GetName           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Used to set names on <a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a>
<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_msg_socket.html#b0c5b480cb6cfbe936453014348e203e">Omiscid::MsgSocket</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00067">67</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_msg_socket_8cpp-source.html#l00180">Omiscid::MsgSocket::GetName()</a>.<div class="fragment"><pre class="fragment"><a name="l00068"></a>00068 {
<a name="l00069"></a>00069     <span class="comment">// Change to all my views...</span>
<a name="l00070"></a>00070     <span class="keywordflow">return</span> <a class="code" href="class_omiscid_1_1_msg_socket.html#b0c5b480cb6cfbe936453014348e203e">TcpServer::GetName</a>();
<a name="l00071"></a>00071 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a6c860f1ce5faf966e080fa657cfae40"></a><!-- doxytag: member="Omiscid::Connector::Cast" ref="a6c860f1ce5faf966e080fa657cfae40" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_com_tools.html">ComTools</a> * Connector::Cast           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Cast in <a class="el" href="class_omiscid_1_1_com_tools.html">ComTools</a>.
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the Comtool pointer on an object that derived Comtool </dd></dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_tcp_server.html#67ee8db36b2ad5308a70c3c7119fef02">Omiscid::TcpServer</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00564">564</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.<div class="fragment"><pre class="fragment"><a name="l00565"></a>00565 {
<a name="l00566"></a>00566     <span class="keywordflow">return</span> dynamic_cast&lt;ComTools*&gt;(<span class="keyword">this</span>);
<a name="l00567"></a>00567 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c812dbd9cc446c38f95d3767a7b98dbc"></a><!-- doxytag: member="Omiscid::Connector::AcceptConnection" ref="c812dbd9cc446c38f95d3767a7b98dbc" args="(const UdpConnection &amp;udp_connection, bool NewConnection)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> * Connector::AcceptConnection           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>udp_connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>NewConnection</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Call on source of UDP message.
<p>
Find the <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> object associated to an UDP connection, or create a new <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> object if it is the first connection (first contact is done with empty message). The research is done by using the peer identifier <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>udp_connection</em>&nbsp;</td><td>[in] the data of the connection, base for the research or the creation of a new <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> object, contains the peer identifier. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NewConnection</em>&nbsp;</td><td>[in] define if the message was done for a new connection. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>NULL if connection refused, or the <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> oebjct associated to the connection. </dd></dl>

<p>
Reimplemented from <a class="el" href="class_omiscid_1_1_udp_exchange.html#1b38216d40b38624b537c92a2fa4aa7c">Omiscid::UdpExchange</a>.
<p>
Definition at line <a class="el" href="_connector_8cpp-source.html#l00414">414</a> of file <a class="el" href="_connector_8cpp-source.html">Connector.cpp</a>.
<p>
References <a class="el" href="_udp_exchange_8cpp-source.html#l00156">Omiscid::UdpExchange::FindConnectionFromId()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01449">Omiscid::UdpConnection::getAddr()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01479">Omiscid::MsgSocket::GetPeerPid()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01464">Omiscid::MsgSocket::IsConnected()</a>, <a class="el" href="_tcp_server_8h-source.html#l00179">Omiscid::TcpServer::listConnections</a>, <a class="el" href="_udp_exchange_8h-source.html#l00148">Omiscid::UdpExchange::listUdpConnections</a>, <a class="el" href="_config_system_8h-source.html#l00234">Omiscid::OmiscidTrace()</a>, <a class="el" href="_msg_socket_8h-source.html#l00084">Omiscid::UdpConnection::pid</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00209">Omiscid::UdpExchange::RemoveConnectionWithId()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00041">Omiscid::UdpConnection::SetAddr()</a>, <a class="el" href="_connector_8h-source.html#l00050">Omiscid::ClientConnection::udpConnection</a>, and <a class="el" href="_lock_management_8cpp-source.html#l00075">Omiscid::SmartLocker::Unlock()</a>.<div class="fragment"><pre class="fragment"><a name="l00415"></a>00415 {
<a name="l00416"></a>00416     <span class="comment">// OmiscidTrace( "in Connector::acceptConnection(UdpConnection*)\n");</span>
<a name="l00417"></a>00417
<a name="l00418"></a>00418     <a class="code" href="class_omiscid_1_1_client_connection.html">ClientConnection</a>  * ClientCon = NULL;
<a name="l00419"></a>00419
<a name="l00420"></a>00420     <span class="comment">// Search in my Client connection</span>
<a name="l00421"></a>00421     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_ListClients(ListClients);
<a name="l00422"></a>00422     <span class="keywordflow">for</span>( ListClients.First(); (ClientCon == NULL) &amp;&amp; ListClients.NotAtEnd(); ListClients.Next())
<a name="l00423"></a>00423     {
<a name="l00424"></a>00424         <span class="keywordflow">if</span>((ListClients.GetCurrent())-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#3426f728c7e5b7e37376dc9ccc0f4d42">GetPeerPid</a>() == udp_connect.pid)
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426             ClientCon = ListClients.GetCurrent();
<a name="l00427"></a>00427         }
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429
<a name="l00430"></a>00430     <span class="comment">// Ok, we've got it, retrieve it</span>
<a name="l00431"></a>00431     <span class="keywordflow">if</span> ( ClientCon )
<a name="l00432"></a>00432     {
<a name="l00433"></a>00433         <span class="keywordflow">if</span> ( NewConnection )
<a name="l00434"></a>00434         {
<a name="l00435"></a>00435             <span class="comment">// We must fill the updConnection</span>
<a name="l00436"></a>00436             <span class="keywordflow">if</span> ( ClientCon-&gt;<a class="code" href="class_omiscid_1_1_client_connection.html#92fc1a1e6b6776c30b5a54934ec97379">udpConnection</a> == NULL )
<a name="l00437"></a>00437             {
<a name="l00438"></a>00438                 ClientCon-&gt;<a class="code" href="class_omiscid_1_1_client_connection.html#92fc1a1e6b6776c30b5a54934ec97379">udpConnection</a> = <span class="keyword">new</span> OMISCID_TLM <a class="code" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a>(udp_connect);
<a name="l00439"></a>00439             }
<a name="l00440"></a>00440             <span class="keywordflow">else</span>
<a name="l00441"></a>00441             {
<a name="l00442"></a>00442                 ClientCon-&gt;<a class="code" href="class_omiscid_1_1_client_connection.html#92fc1a1e6b6776c30b5a54934ec97379">udpConnection</a>-&gt;<a class="code" href="class_omiscid_1_1_udp_connection.html#6a870b7e92f2bad9a2c412d055fa4407">SetAddr</a>( udp_connect.getAddr() );
<a name="l00443"></a>00443             }
<a name="l00444"></a>00444         }
<a name="l00445"></a>00445
<a name="l00446"></a>00446         <span class="keywordflow">return</span> ClientCon-&gt;<a class="code" href="class_omiscid_1_1_client_connection.html#92fc1a1e6b6776c30b5a54934ec97379">udpConnection</a>;
<a name="l00447"></a>00447     }
<a name="l00448"></a>00448
<a name="l00449"></a>00449     SL_ListClients.Unlock();
<a name="l00450"></a>00450
<a name="l00451"></a>00451     <span class="comment">// Now search in the person connected to me</span>
<a name="l00452"></a>00452
<a name="l00453"></a>00453     <a class="code" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a>* udp_found = NULL;
<a name="l00454"></a>00454     <a class="code" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a>*   tcp_found = NULL;
<a name="l00455"></a>00455
<a name="l00456"></a>00456     <span class="comment">//std::cout &lt;&lt; "recherche dans server connexion\n";</span>
<a name="l00457"></a>00457     <a class="code" href="class_omiscid_1_1_smart_locker.html">SmartLocker</a> SL_TcpServer_listConnections(<a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>);
<a name="l00458"></a>00458     <span class="keywordflow">try</span>
<a name="l00459"></a>00459     {
<a name="l00460"></a>00460
<a name="l00461"></a>00461         <span class="keywordflow">for</span>(<a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.First(); (tcp_found == NULL) &amp;&amp; <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.NotAtEnd();
<a name="l00462"></a>00462             <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.Next())
<a name="l00463"></a>00463         {
<a name="l00464"></a>00464             <span class="comment">// OmiscidTrace( "among  connexion server : %u\n", (*its)-&gt;GetPeerPid());</span>
<a name="l00465"></a>00465             <span class="keywordflow">if</span> ( udp_connect.pid == (<a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.GetCurrent())-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#3426f728c7e5b7e37376dc9ccc0f4d42">GetPeerPid</a>())
<a name="l00466"></a>00466             {
<a name="l00467"></a>00467                 tcp_found = <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.GetCurrent();
<a name="l00468"></a>00468             }
<a name="l00469"></a>00469         }
<a name="l00470"></a>00470
<a name="l00471"></a>00471         <span class="keywordflow">if</span> ( tcp_found )
<a name="l00472"></a>00472         {
<a name="l00473"></a>00473             <span class="keywordflow">if</span>( tcp_found-&gt;<a class="code" href="class_omiscid_1_1_msg_socket.html#21e5b5ec66ef490dec3d957711b91c90">IsConnected</a>() )
<a name="l00474"></a>00474             {
<a name="l00475"></a>00475                 udp_found = <a class="code" href="class_omiscid_1_1_udp_exchange.html#f24431f24cb168b9e2a5772fed587a4d">UdpExchange::FindConnectionFromId</a>(udp_connect.pid);
<a name="l00476"></a>00476                 <span class="keywordflow">if</span> ( NewConnection )
<a name="l00477"></a>00477                 {
<a name="l00478"></a>00478                     <span class="keywordflow">if</span> ( udp_found != NULL )
<a name="l00479"></a>00479                     {
<a name="l00480"></a>00480                         udp_found-&gt;<a class="code" href="class_omiscid_1_1_udp_connection.html#6a870b7e92f2bad9a2c412d055fa4407">SetAddr</a>( udp_connect.getAddr() );
<a name="l00481"></a>00481                     }
<a name="l00482"></a>00482                     <span class="keywordflow">else</span>
<a name="l00483"></a>00483                     {
<a name="l00484"></a>00484                         <span class="comment">// OmiscidTrace("Creation connection udp associe TcpServer\n");</span>
<a name="l00485"></a>00485                         udp_found = <span class="keyword">new</span> OMISCID_TLM <a class="code" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a>(udp_connect);
<a name="l00486"></a>00486                         <span class="keywordflow">if</span> ( udp_found )
<a name="l00487"></a>00487                         {
<a name="l00488"></a>00488                             <a class="code" href="class_omiscid_1_1_udp_exchange.html#08383e43746e1b5184e6f7e39fedf3bc">UdpExchange::listUdpConnections</a>.Add(udp_found);
<a name="l00489"></a>00489                         }
<a name="l00490"></a>00490                     }
<a name="l00491"></a>00491                 }
<a name="l00492"></a>00492             }
<a name="l00493"></a>00493             <span class="keywordflow">else</span>
<a name="l00494"></a>00494             {
<a name="l00495"></a>00495                 <span class="comment">// The peer is not connected anymore, remove it from my list</span>
<a name="l00496"></a>00496                 <a class="code" href="class_omiscid_1_1_tcp_server.html#3ecdc7f7288bc477b9a587cbbc5b99af">TcpServer::listConnections</a>.Remove(tcp_found);
<a name="l00497"></a>00497                 <a class="code" href="class_omiscid_1_1_udp_exchange.html#1f8cbb08e7960ae5d640583dcb0a46cc">UdpExchange::RemoveConnectionWithId</a>( udp_connect.pid );
<a name="l00498"></a>00498                 <span class="keyword">delete</span> tcp_found;
<a name="l00499"></a>00499             }
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501     } <span class="keywordflow">catch</span>(...)
<a name="l00502"></a>00502     {
<a name="l00503"></a>00503     }
<a name="l00504"></a>00504
<a name="l00505"></a>00505     SL_TcpServer_listConnections.Unlock();
<a name="l00506"></a>00506
<a name="l00507"></a>00507     <span class="keywordflow">if</span>( udp_found == NULL )
<a name="l00508"></a>00508     {
<a name="l00509"></a>00509         <a class="code" href="namespace_omiscid.html#75386ddb9b14af103045f0df7c2b2429">OmiscidTrace</a>( <span class="stringliteral">"UDP connection not available fo peer %8.8x\n"</span>, udp_connect.pid);
<a name="l00510"></a>00510     }
<a name="l00511"></a>00511
<a name="l00512"></a>00512     <span class="keywordflow">return</span> udp_found;
<a name="l00513"></a>00513 }
</pre></div>
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>Com/Com/<a class="el" href="_connector_8h-source.html">Connector.h</a><li>Com/<a class="el" href="_connector_8cpp-source.html">Connector.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Mar 27 10:20:38 2008 for OMiSCID(aka O3MiSCID) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
