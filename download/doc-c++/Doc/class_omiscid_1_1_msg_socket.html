<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OMiSCID(aka O3MiSCID): Omiscid::MsgSocket Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>Omiscid</b>::<a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a>
  </div>
</div>
<div class="contents">
<h1>Omiscid::MsgSocket Class Reference</h1><!-- doxytag: class="Omiscid::MsgSocket" --><!-- doxytag: inherits="Omiscid::Thread" --><a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> with an implementation of Basic Interconnection Protocol to exchange message.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_msg_socket_8h-source.html">Com/MsgSocket.h</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for Omiscid::MsgSocket:</div>
<div class="dynsection">

<p><center><img src="class_omiscid_1_1_msg_socket.png" usemap="#Omiscid::MsgSocket_map" border="0" alt=""></center>
<map name="Omiscid::MsgSocket_map">
<area href="class_omiscid_1_1_thread.html" alt="Omiscid::Thread" shape="rect" coords="229,0,372,24">
<area href="class_omiscid_1_1_tcp_client.html" alt="Omiscid::TcpClient" shape="rect" coords="0,112,143,136">
<area href="class_omiscid_1_1_tcp_server.html" alt="Omiscid::TcpServer" shape="rect" coords="229,112,372,136">
<area href="class_omiscid_1_1_udp_exchange.html" alt="Omiscid::UdpExchange" shape="rect" coords="459,112,602,136">
<area href="class_omiscid_1_1_control_client.html" alt="Omiscid::ControlClient" shape="rect" coords="0,168,143,192">
<area href="class_omiscid_1_1_connector.html" alt="Omiscid::Connector" shape="rect" coords="153,168,296,192">
<area href="class_omiscid_1_1_control_server.html" alt="Omiscid::ControlServer" shape="rect" coords="306,168,449,192">
<area href="class_omiscid_1_1_connector.html" alt="Omiscid::Connector" shape="rect" coords="459,168,602,192">
<area href="class_omiscid_1_1_service_proxy.html" alt="Omiscid::ServiceProxy" shape="rect" coords="0,224,143,248">
<area href="class_omiscid_1_1_service.html" alt="Omiscid::Service" shape="rect" coords="306,224,449,248">
</map>
</div>

<p>
<a href="class_omiscid_1_1_msg_socket-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b">MsgSocketKind</a> { , <a class="el" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b37eed2ba19df9c46649c797a72cc2d7f">TCP_CLIENT_KIND</a> =  0, 
<a class="el" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b0ecdad184663d729a7c9ab6b9fcc73f5">TCP_SERVER_KIND</a>, 
<a class="el" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b26b29a312b497622aad9256945d6b8cb">UDP_EXCHANGE_KIND</a>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Kind of use of a <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> object.  <a href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="755a9ab6299c74f203aec3ae5a4a4c47"></a><!-- doxytag: member="Omiscid::MsgSocket::Callback_SyncLink" ref="755a9ab6299c74f203aec3ae5a4a4c47" args=")(MsgSocketCallBackData *, MsgSocket *)" -->
typedef void(FUNCTION_CALL_TYPE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#755a9ab6299c74f203aec3ae5a4a4c47">Callback_SyncLink</a> )(<a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a> *, <a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback for the message reception. <br></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#7ce223225245ecb8b90d7344f86c2bd6">MsgSocket</a> (<a class="el" href="class_omiscid_1_1_socket.html">Socket</a> *s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#7ce223225245ecb8b90d7344f86c2bd6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#9954697cc56589a9d9e4a2d5adbd60f0">MsgSocket</a> (<a class="el" href="class_omiscid_1_1_socket.html#534fbf67274aee620617b048b84ff86a">Socket::SocketKind</a> type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#9954697cc56589a9d9e4a2d5adbd60f0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b5b28d057094d058c5445069f087bd93"></a><!-- doxytag: member="Omiscid::MsgSocket::~MsgSocket" ref="b5b28d057094d058c5445069f087bd93" args="()" -->
virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#b5b28d057094d058c5445069f087bd93">~MsgSocket</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#c04b57b1d0c89fe9c24ee667ba838ddb">InitForTcpClient</a> (const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a> addr, int port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization for TCP Client.  <a href="#c04b57b1d0c89fe9c24ee667ba838ddb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#91aca9a8ded8f7a4801aa4c6e462bdda">InitForTcpServer</a> (int port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization for TCP Server.  <a href="#91aca9a8ded8f7a4801aa4c6e462bdda"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#568d6346baef454c48105712e402d6bd">InitForUdpExchange</a> (int port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization for UDP Exchange.  <a href="#568d6346baef454c48105712e402d6bd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#e6a4e463d7f2b49842a19ef632607b91">AddCallbackObject</a> (<a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *CallbackObject)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">define callback function called in receive  <a href="#e6a4e463d7f2b49842a19ef632607b91"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#749006fded14bc52f629ffa9cccdacf8">RemoveCallbackObject</a> (<a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *CallbackObject)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove the callback for message reception.  <a href="#749006fded14bc52f629ffa9cccdacf8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cdc438cbf9829f9faceea68bd2535f67"></a><!-- doxytag: member="Omiscid::MsgSocket::RemoveAllCallbackObjects" ref="cdc438cbf9829f9faceea68bd2535f67" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#cdc438cbf9829f9faceea68bd2535f67">RemoveAllCallbackObjects</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove all the callback object for notification. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#dcae5a3be1bbfd31d4cbbe820d68a970">SetCallbackSyncLink</a> (<a class="el" href="class_omiscid_1_1_msg_socket.html#755a9ab6299c74f203aec3ae5a4a4c47">Callback_SyncLink</a> cr, void *user_data1=NULL, void *user_data2=NULL)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">define callback function called in receive  <a href="#dcae5a3be1bbfd31d4cbbe820d68a970"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void FUNCTION_CALL_TYPE&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#01ceb5ec9a28d28fcf402acf5c35fbef">Run</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">method call when the <a class="el" href="class_omiscid_1_1_thread.html" title="Thread Implementation.">Thread</a> is started  <a href="#01ceb5ec9a28d28fcf402acf5c35fbef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#7496fe09ce10bd84eac5ea6e44c8bc31">Send</a> (int len, const char *buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message (on TCP) by using the BIP protocol.  <a href="#7496fe09ce10bd84eac5ea6e44c8bc31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#b80c9ed1145f7d4e42240f6b8de09c0f">SendPreparedBuffer</a> (int len, char *buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a preformated BIP message (on TCP) by using the BIP protocol.  <a href="#b80c9ed1145f7d4e42240f6b8de09c0f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#4a2314b70a47858c24edbaa8636bcbe6">SendCuttedMsg</a> (int *tab_len, const char **tab_buf, int nb_buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message in several part (on TCP) by using the BIP protocol.  <a href="#4a2314b70a47858c24edbaa8636bcbe6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#5c449b68e25f5cf173d0a69a699a975b">SendTo</a> (int len, const char *buf, <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> *udp_dest)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_omiscid_1_1_socket.html">Socket</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#66d6616574ad4f410e424a1e12fe1106">GetSocket</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the socket object.  <a href="#66d6616574ad4f410e424a1e12fe1106"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#abc7fca62eb753cff2f578a4fbbdfa79">GetPortNb</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to Port number.  <a href="#abc7fca62eb753cff2f578a4fbbdfa79"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#643130a0e78dc5780e41571149ffb31c">IsConnected</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Test if the <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> is in usage.  <a href="#643130a0e78dc5780e41571149ffb31c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#36d29279121e5b48c35df617c095734b">Stop</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop the <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a>.  <a href="#36d29279121e5b48c35df617c095734b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#7567f7b5736b8363e464cec76a978276">SetServiceId</a> (unsigned int pid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the service Id.  <a href="#7567f7b5736b8363e464cec76a978276"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#c462f84f6ce4bf81a07af2a07513a3c1">GetServiceId</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the service Id.  <a href="#c462f84f6ce4bf81a07af2a07513a3c1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#11758f2a2dd4bb671849cb1856ee9a91">GetPeerPid</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#ed776388f004399875e8629248d4f655">ReceivedSyncLinkMsg</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">test if the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> has received the link message  <a href="#ed776388f004399875e8629248d4f655"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#7d87ebb3ed18bb10f3074e2730feb9e6">WaitSyncLinkMsg</a> (unsigned int TimeToWait=250)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">wait for a synclink message  <a href="#7d87ebb3ed18bb10f3074e2730feb9e6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#3ea7ed453da5945b9268aaf374059388">SyncLinkMsgSent</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">test if the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> has sent the link message  <a href="#3ea7ed453da5945b9268aaf374059388"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#30b58f15022ccc68fc521c4c34429892">GetMaxMessageSizeForTCP</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">size max for message on TCP  <a href="#30b58f15022ccc68fc521c4c34429892"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="88ed9e61763cf158e962a9f5cd342f5f"></a><!-- doxytag: member="Omiscid::MsgSocket::SetMaxMessageSizeForTCP" ref="88ed9e61763cf158e962a9f5cd342f5f" args="(int max)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#88ed9e61763cf158e962a9f5cd342f5f">SetMaxMessageSizeForTCP</a> (int max)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">size max for message on TCP Define the size max accepted for exchange on TCP (by default the value is 1&lt;&lt;16) <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#8763f358c828376a54834a2a7520a603">operator==</a> (unsigned int peer_id) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compare the peer id.  <a href="#8763f358c828376a54834a2a7520a603"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#853ad7a7a3b7ea7afa9dff79a74ddc1a">SetTcpNoDelay</a> (bool Set=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the undelying socket in non buffering mode if possible.  <a href="#853ad7a7a3b7ea7afa9dff79a74ddc1a"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Naming connecting points</div></td></tr>
<tr><td colspan="2"><div class="groupText"><br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#e23f86137b974c4b6aea0d07997a0bc3">SetName</a> (const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a> NewName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#b0c5b480cb6cfbe936453014348e203e">GetName</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#626bf84517ed66dd14358ba09da0dac4">AcceptConnection</a> (<a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a> *s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accept new TCP connection.  <a href="#626bf84517ed66dd14358ba09da0dac4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#0a89a1c77bf9ff30f5fe2c130191429b">AcceptConnection</a> (const <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> &amp;udp_connect, bool msg_empty)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accept new UDP connection.  <a href="#0a89a1c77bf9ff30f5fe2c130191429b"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_omiscid_1_1_mutexed_simple_list.html">MutexedSimpleList</a><br>
&lt; <a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#deba601f8dc26650cf4168a4bcc2c03a">callbackData</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_omiscid_1_1_mutex.html">Mutex</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#f8de8404f66db44e0a1beed0d48abb7f">mutex</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_omiscid_1_1_msg_socket.html#755a9ab6299c74f203aec3ae5a4a4c47">Callback_SyncLink</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_omiscid_1_1_msg_socket.html#eafc599eec5aca8cfeea9727bf984f46">callbackSyncLinkFct</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> with an implementation of Basic Interconnection Protocol to exchange message. 
<p>
The 'size' bytes of the message are between : BIP\1.0 pid(8 bytes) mid(8 bytes) size(8 bytes)\r\n and \r\n When a new message arrives, the callback function 'callbackReceive' is called with the object 'callbackData' which contains the data.<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Sebastien Pesnel <p>
Dominique Vaufreydaz </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8h-source.html#l00122">122</a> of file <a class="el" href="_msg_socket_8h-source.html">MsgSocket.h</a>.</p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="4d9ba56644652acfe0e4f6ade0e9659b"></a><!-- doxytag: member="Omiscid::MsgSocket::MsgSocketKind" ref="4d9ba56644652acfe0e4f6ade0e9659b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b">Omiscid::MsgSocket::MsgSocketKind</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Kind of use of a <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> object. 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="4d9ba56644652acfe0e4f6ade0e9659b37eed2ba19df9c46649c797a72cc2d7f"></a><!-- doxytag: member="TCP_CLIENT_KIND" ref="4d9ba56644652acfe0e4f6ade0e9659b37eed2ba19df9c46649c797a72cc2d7f" args="" -->TCP_CLIENT_KIND</em>&nbsp;</td><td>
for TCP connection : client side </td></tr>
<tr><td valign="top"><em><a class="anchor" name="4d9ba56644652acfe0e4f6ade0e9659b0ecdad184663d729a7c9ab6b9fcc73f5"></a><!-- doxytag: member="TCP_SERVER_KIND" ref="4d9ba56644652acfe0e4f6ade0e9659b0ecdad184663d729a7c9ab6b9fcc73f5" args="" -->TCP_SERVER_KIND</em>&nbsp;</td><td>
for TCP connection : server side </td></tr>
<tr><td valign="top"><em><a class="anchor" name="4d9ba56644652acfe0e4f6ade0e9659b26b29a312b497622aad9256945d6b8cb"></a><!-- doxytag: member="UDP_EXCHANGE_KIND" ref="4d9ba56644652acfe0e4f6ade0e9659b26b29a312b497622aad9256945d6b8cb" args="" -->UDP_EXCHANGE_KIND</em>&nbsp;</td><td>
for UDP connection </td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="_msg_socket_8h-source.html#l00144">144</a> of file <a class="el" href="_msg_socket_8h-source.html">MsgSocket.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00145"></a>00145     {
<a name="l00146"></a>00146       NONE_KIND = -1,
<a name="l00147"></a>00147       <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b37eed2ba19df9c46649c797a72cc2d7f">TCP_CLIENT_KIND</a> = 0, 
<a name="l00148"></a>00148       <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b0ecdad184663d729a7c9ab6b9fcc73f5">TCP_SERVER_KIND</a>, 
<a name="l00149"></a>00149       <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b26b29a312b497622aad9256945d6b8cb">UDP_EXCHANGE_KIND</a> 
<a name="l00150"></a>00150     };
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="7ce223225245ecb8b90d7344f86c2bd6"></a><!-- doxytag: member="Omiscid::MsgSocket::MsgSocket" ref="7ce223225245ecb8b90d7344f86c2bd6" args="(Socket *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MsgSocket::MsgSocket           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_socket.html">Socket</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor. 
<p>
Create an object <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> built on the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> s. Used in TcpConnection to manage a new connection. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td><a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> creates for the new tcp connection. (example : <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> returned by Accept method) </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00084">84</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8cpp-source.html#l01527">SetMaxMessageSizeForTCP()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00084"></a>00084                               :
<a name="l00085"></a>00085 <span class="preprocessor">#ifdef DEBUG_THREAD</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>    <a class="code" href="class_omiscid_1_1_thread.html#95c703fb8f2f27cb64f475a8c940864a" title="Constructor.">Thread</a>( <span class="stringliteral">"MsgSocket"</span> ),
<a name="l00087"></a>00087 <span class="preprocessor">#else</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span>    <a class="code" href="class_omiscid_1_1_thread.html#95c703fb8f2f27cb64f475a8c940864a" title="Constructor.">Thread</a>(),
<a name="l00089"></a>00089 <span class="preprocessor">#endif</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><a class="code" href="class_omiscid_1_1_msg_socket.html#eafc599eec5aca8cfeea9727bf984f46">callbackSyncLinkFct</a>(NULL),
<a name="l00091"></a>00091 socket(s),
<a name="l00092"></a>00092 bufferSize(TCP_BUFFER_SIZE),
<a name="l00093"></a>00093 buffer(NULL),
<a name="l00094"></a>00094 occupiedSize(0),
<a name="l00095"></a>00095 connected(<span class="keyword">true</span>),
<a name="l00096"></a>00096 start_tag(NULL),
<a name="l00097"></a>00097 buffer_udp_send(NULL),
<a name="l00098"></a>00098 kind(<a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b37eed2ba19df9c46649c797a72cc2d7f">TCP_CLIENT_KIND</a>),
<a name="l00099"></a>00099 SendBuffer(NULL),
<a name="l00100"></a>00100 service_id(0),
<a name="l00101"></a>00101 message_id(0),
<a name="l00102"></a>00102 peer_pid(0),
<a name="l00103"></a>00103 receivedSyncLinkMsg(<span class="keyword">false</span>),
<a name="l00104"></a>00104 sendSyncLinkMsg(<span class="keyword">false</span>)
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106     buffer = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[bufferSize+1];                       <span class="comment">// +1 for '\0'</span>
<a name="l00107"></a>00107     SendBuffer = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[TCP_BUFFER_SIZE];        <span class="comment">// +1 for '\0'</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     start_tag = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">char</span>[tag_size+1];
<a name="l00110"></a>00110     <a class="code" href="class_omiscid_1_1_msg_socket.html#88ed9e61763cf158e962a9f5cd342f5f" title="size max for message on TCP Define the size max accepted for exchange on TCP (by...">SetMaxMessageSizeForTCP</a>(TCP_BUFFER_SIZE-1);
<a name="l00111"></a>00111 }

</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9954697cc56589a9d9e4a2d5adbd60f0"></a><!-- doxytag: member="Omiscid::MsgSocket::MsgSocket" ref="9954697cc56589a9d9e4a2d5adbd60f0" args="(Socket::SocketKind type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MsgSocket::MsgSocket           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_socket.html#534fbf67274aee620617b048b84ff86a">Socket::SocketKind</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor. 
<p>
Create an <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> for TCP or UDP communication. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>gives the kind of socket :<ul>
<li>Socket::TCP for TCP connection,</li><li>Socket::UDP for UDP connection. </li></ul>
</td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00113">113</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8cpp-source.html#l01527">SetMaxMessageSizeForTCP()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00113"></a>00113                                           :
<a name="l00114"></a>00114 <span class="preprocessor">#ifdef DEBUG_THREAD</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span>    <a class="code" href="class_omiscid_1_1_thread.html#95c703fb8f2f27cb64f475a8c940864a" title="Constructor.">Thread</a>( <span class="stringliteral">"MsgSocket"</span> ),
<a name="l00116"></a>00116 <span class="preprocessor">#else</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>    <a class="code" href="class_omiscid_1_1_thread.html#95c703fb8f2f27cb64f475a8c940864a" title="Constructor.">Thread</a>(),
<a name="l00118"></a>00118 <span class="preprocessor">#endif</span>
<a name="l00119"></a>00119 <span class="preprocessor"></span><a class="code" href="class_omiscid_1_1_msg_socket.html#eafc599eec5aca8cfeea9727bf984f46">callbackSyncLinkFct</a>(NULL),
<a name="l00120"></a>00120 socket(NULL),
<a name="l00121"></a>00121 bufferSize(0),
<a name="l00122"></a>00122 buffer(NULL),
<a name="l00123"></a>00123 occupiedSize(0),
<a name="l00124"></a>00124 connected(<span class="keyword">false</span>),
<a name="l00125"></a>00125 start_tag(NULL),
<a name="l00126"></a>00126 buffer_udp_send(NULL),
<a name="l00127"></a>00127 kind(NONE_KIND),
<a name="l00128"></a>00128 SendBuffer(NULL),
<a name="l00129"></a>00129 service_id(0),
<a name="l00130"></a>00130 message_id(0),
<a name="l00131"></a>00131 peer_pid(0),
<a name="l00132"></a>00132 receivedSyncLinkMsg(<span class="keyword">false</span>),
<a name="l00133"></a>00133 sendSyncLinkMsg(<span class="keyword">false</span>)
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135     socket = <span class="keyword">new</span> OMISCID_TLM <a class="code" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a>(type);
<a name="l00136"></a>00136     <a class="code" href="class_omiscid_1_1_msg_socket.html#88ed9e61763cf158e962a9f5cd342f5f" title="size max for message on TCP Define the size max accepted for exchange on TCP (by...">SetMaxMessageSizeForTCP</a>(TCP_BUFFER_SIZE-1);
<a name="l00137"></a>00137 }

</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="c04b57b1d0c89fe9c24ee667ba838ddb"></a><!-- doxytag: member="Omiscid::MsgSocket::InitForTcpClient" ref="c04b57b1d0c89fe9c24ee667ba838ddb" args="(const SimpleString addr, int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MsgSocket::InitForTcpClient           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialization for TCP Client. 
<p>
Connection to a TCP server <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>[in] host where find the server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>[in] port where listen the server </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00364">364</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_socket_8cpp-source.html#l00274">Omiscid::Socket::Connect()</a>, and <a class="el" href="_msg_socket_8h-source.html#l00147">TCP_CLIENT_KIND</a>.</p>

<p>Referenced by <a class="el" href="_tcp_client_8cpp-source.html#l00021">Omiscid::TcpClient::ConnectToServer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00365"></a>00365 {
<a name="l00366"></a>00366     socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#b211f8e5b45761f775d2735652174c98" title="Initiate a connection on a socket.">Connect</a>(addr, port);
<a name="l00367"></a>00367     bufferSize = TCP_BUFFER_SIZE;
<a name="l00368"></a>00368     buffer = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[bufferSize+1];       <span class="comment">// + 1 for ending '\0'</span>
<a name="l00369"></a>00369     <span class="keywordflow">if</span> ( buffer == NULL )
<a name="l00370"></a>00370     {
<a name="l00371"></a>00371         <span class="keywordflow">throw</span> <a class="code" href="class_omiscid_1_1_msg_socket_exception.html" title="Exception thrown by the class MsgSocket.">MsgSocketException</a>( <span class="stringliteral">"Not enougth memory"</span> );
<a name="l00372"></a>00372     }
<a name="l00373"></a>00373     SendBuffer = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[TCP_BUFFER_SIZE+1];      <span class="comment">// + 1 for ending '\0'</span>
<a name="l00374"></a>00374     <span class="keywordflow">if</span> ( SendBuffer == NULL )
<a name="l00375"></a>00375     {
<a name="l00376"></a>00376         <span class="keywordflow">throw</span> <a class="code" href="class_omiscid_1_1_msg_socket_exception.html" title="Exception thrown by the class MsgSocket.">MsgSocketException</a>( <span class="stringliteral">"Not enougth memory"</span> );
<a name="l00377"></a>00377     }
<a name="l00378"></a>00378     start_tag = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">char</span>[tag_size+1];
<a name="l00379"></a>00379     <span class="keywordflow">if</span> ( start_tag == NULL )
<a name="l00380"></a>00380     {
<a name="l00381"></a>00381         <span class="keywordflow">throw</span> <a class="code" href="class_omiscid_1_1_msg_socket_exception.html" title="Exception thrown by the class MsgSocket.">MsgSocketException</a>( <span class="stringliteral">"Not enougth memory"</span> );
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383     kind = <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b37eed2ba19df9c46649c797a72cc2d7f">TCP_CLIENT_KIND</a>;
<a name="l00384"></a>00384     connected = <span class="keyword">true</span>;
<a name="l00385"></a>00385     occupiedSize = 0;
<a name="l00386"></a>00386 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="91aca9a8ded8f7a4801aa4c6e462bdda"></a><!-- doxytag: member="Omiscid::MsgSocket::InitForTcpServer" ref="91aca9a8ded8f7a4801aa4c6e462bdda" args="(int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MsgSocket::InitForTcpServer           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialization for TCP Server. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>[in] port number where the server must listen (if null a free port is chosen) </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00388">388</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_socket_8cpp-source.html#l00114">Omiscid::Socket::Bind()</a>, <a class="el" href="_simple_string_8h-source.html#l00249">Omiscid::SimpleString::EmptyString</a>, <a class="el" href="_socket_8cpp-source.html#l00155">Omiscid::Socket::Listen()</a>, and <a class="el" href="_msg_socket_8h-source.html#l00148">TCP_SERVER_KIND</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00036">Omiscid::TcpServer::Create()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00389"></a>00389 {
<a name="l00390"></a>00390     socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#309a0816cad7f62b0b3a3d9dafe03b89" title="Bind the socket to addr:port.">Bind</a>(<a class="code" href="class_omiscid_1_1_simple_string.html#c6fd8dc249665e634760ba47fe32e983">SimpleString::EmptyString</a>, port);
<a name="l00391"></a>00391     socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#4ddc75d91bf3ec294902523aa570357e" title="Listen for connections on a socket. error calling listen.">Listen</a>();
<a name="l00392"></a>00392     kind = <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b0ecdad184663d729a7c9ab6b9fcc73f5">TCP_SERVER_KIND</a>;
<a name="l00393"></a>00393     connected = <span class="keyword">true</span>;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395     <span class="comment">//   unsigned short port_nb = socket-&gt;GetPortNb();</span>
<a name="l00396"></a>00396     <span class="comment">//   char hostname[256];</span>
<a name="l00397"></a>00397     <span class="comment">//   socket-&gt;GetHostName(hostname, 256);</span>
<a name="l00398"></a>00398 
<a name="l00399"></a>00399     <span class="comment">//   printf("Server Connected on : %s:%d", hostname, (int)port_nb);</span>
<a name="l00400"></a>00400 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="568d6346baef454c48105712e402d6bd"></a><!-- doxytag: member="Omiscid::MsgSocket::InitForUdpExchange" ref="568d6346baef454c48105712e402d6bd" args="(int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MsgSocket::InitForUdpExchange           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialization for UDP Exchange. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>[in] port where wait for connections </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00403">403</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_socket_8cpp-source.html#l00114">Omiscid::Socket::Bind()</a>, <a class="el" href="_simple_string_8h-source.html#l00249">Omiscid::SimpleString::EmptyString</a>, and <a class="el" href="_msg_socket_8h-source.html#l00149">UDP_EXCHANGE_KIND</a>.</p>

<p>Referenced by <a class="el" href="_udp_exchange_8cpp-source.html#l00025">Omiscid::UdpExchange::Create()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00404"></a>00404 {
<a name="l00405"></a>00405     socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#309a0816cad7f62b0b3a3d9dafe03b89" title="Bind the socket to addr:port.">Bind</a>(<a class="code" href="class_omiscid_1_1_simple_string.html#c6fd8dc249665e634760ba47fe32e983">SimpleString::EmptyString</a>, port);
<a name="l00406"></a>00406     bufferSize = TCP_BUFFER_SIZE;
<a name="l00407"></a>00407     buffer = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[bufferSize+1];               <span class="comment">// +1 for '\0'</span>
<a name="l00408"></a>00408     buffer_udp_send = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">char</span>[UDP_MAX_MSG_SIZE+1]; <span class="comment">// +1 for '\0'</span>
<a name="l00409"></a>00409     kind = <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b26b29a312b497622aad9256945d6b8cb">UDP_EXCHANGE_KIND</a>;
<a name="l00410"></a>00410     connected = <span class="keyword">true</span>;
<a name="l00411"></a>00411     occupiedSize = 0;
<a name="l00412"></a>00412 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e6a4e463d7f2b49842a19ef632607b91"></a><!-- doxytag: member="Omiscid::MsgSocket::AddCallbackObject" ref="e6a4e463d7f2b49842a19ef632607b91" args="(MsgSocketCallbackObject *CallbackObject)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::AddCallbackObject           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *&nbsp;</td>
          <td class="paramname"> <em>CallbackObject</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
define callback function called in receive 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>a</em>&nbsp;</td><td>callback object to notify </td></tr>
  </table>
</dl>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_connector.html#580c5205fd1516a5f508ab9cc39a7eb1">Omiscid::Connector</a>, and <a class="el" href="class_omiscid_1_1_tcp_server.html#d1c7a4f33733a8a33c7580d2f96ac1d4">Omiscid::TcpServer</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00415">415</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8h-source.html#l00392">CallbackObjects</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00331">Omiscid::TcpServer::AddCallbackObject()</a>, <a class="el" href="_connector_8cpp-source.html#l00350">Omiscid::Connector::AddCallbackObject()</a>, <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>, and <a class="el" href="_control_client_8cpp-source.html#l00233">Omiscid::ControlClient::ControlClient()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00416"></a>00416 {
<a name="l00417"></a>00417     <span class="comment">// lock the list</span>
<a name="l00418"></a>00418     <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420     <span class="comment">// Is the Callback object already in the list ?</span>
<a name="l00421"></a>00421     <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Next() )
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423         <span class="keywordflow">if</span> ( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.GetCurrent() == CallbackObject )
<a name="l00424"></a>00424         {
<a name="l00425"></a>00425             <span class="comment">// Could not add trice the same listener</span>
<a name="l00426"></a>00426             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00427"></a>00427         }
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="comment">// Add the listener</span>
<a name="l00431"></a>00431     <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Add( CallbackObject );
<a name="l00432"></a>00432 
<a name="l00433"></a>00433     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00434"></a>00434 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="749006fded14bc52f629ffa9cccdacf8"></a><!-- doxytag: member="Omiscid::MsgSocket::RemoveCallbackObject" ref="749006fded14bc52f629ffa9cccdacf8" args="(MsgSocketCallbackObject *CallbackObject)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::RemoveCallbackObject           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a> *&nbsp;</td>
          <td class="paramname"> <em>CallbackObject</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remove the callback for message reception. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>a</em>&nbsp;</td><td>callback object to remove from notification list</td></tr>
  </table>
</dl>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_connector.html#f22b8e86e1a4768b9f78a7fa2304b58d">Omiscid::Connector</a>, and <a class="el" href="class_omiscid_1_1_tcp_server.html#4e34be9756270406e5cad5ef1e6c988f">Omiscid::TcpServer</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00440">440</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8h-source.html#l00392">CallbackObjects</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00357">Omiscid::TcpServer::RemoveCallbackObject()</a>, and <a class="el" href="_connector_8cpp-source.html#l00378">Omiscid::Connector::RemoveCallbackObject()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00441"></a>00441 {
<a name="l00442"></a>00442     <span class="comment">// lock the list</span>
<a name="l00443"></a>00443     <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>);
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <span class="comment">// Is the Callback object already in the list ?</span>
<a name="l00446"></a>00446     <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Next() )
<a name="l00447"></a>00447     {
<a name="l00448"></a>00448         <span class="keywordflow">if</span> ( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.GetCurrent() == CallbackObject )
<a name="l00449"></a>00449         {
<a name="l00450"></a>00450             <span class="comment">// Found ! Remove it</span>
<a name="l00451"></a>00451             <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.RemoveCurrent();
<a name="l00452"></a>00452 
<a name="l00453"></a>00453             <span class="comment">// ok, we remove it</span>
<a name="l00454"></a>00454             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00455"></a>00455         }
<a name="l00456"></a>00456     }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="comment">// We did not find it</span>
<a name="l00459"></a>00459     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00460"></a>00460 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e23f86137b974c4b6aea0d07997a0bc3"></a><!-- doxytag: member="Omiscid::MsgSocket::SetName" ref="e23f86137b974c4b6aea0d07997a0bc3" args="(const SimpleString NewName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MsgSocket::SetName           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a>&nbsp;</td>
          <td class="paramname"> <em>NewName</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Used to set names on <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> 
<p>Reimplemented in <a class="el" href="class_omiscid_1_1_connector.html#5723d5976e777a330a152ec8f13bbbe4">Omiscid::Connector</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00175">175</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>, and <a class="el" href="_connector_8cpp-source.html#l00053">Omiscid::Connector::SetName()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00176"></a>00176 {
<a name="l00177"></a>00177     Name = NewName;
<a name="l00178"></a>00178 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b0c5b480cb6cfbe936453014348e203e"></a><!-- doxytag: member="Omiscid::MsgSocket::GetName" ref="b0c5b480cb6cfbe936453014348e203e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_omiscid_1_1_simple_string.html">SimpleString</a> MsgSocket::GetName           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Used to set names on <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> 
<p>Reimplemented in <a class="el" href="class_omiscid_1_1_connector.html#5e22460fe080d9818cb6dd3accc0a121">Omiscid::Connector</a>, <a class="el" href="class_omiscid_1_1_service.html#8a23c9630d2db2128e36ada08fee6429">Omiscid::Service</a>, and <a class="el" href="class_omiscid_1_1_service_proxy.html#941d508da01ac820390cb154f693c2e1">Omiscid::ServiceProxy</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00180">180</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_simple_string_8cpp-source.html#l00907">Omiscid::SimpleString::IsEmpty()</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>, <a class="el" href="_control_client_8cpp-source.html#l00835">Omiscid::ControlClient::FindInOutput()</a>, <a class="el" href="_control_client_8cpp-source.html#l00817">Omiscid::ControlClient::FindInput()</a>, <a class="el" href="_control_client_8cpp-source.html#l00826">Omiscid::ControlClient::FindOutput()</a>, <a class="el" href="_control_client_8cpp-source.html#l00807">Omiscid::ControlClient::FindVariable()</a>, and <a class="el" href="_connector_8cpp-source.html#l00067">Omiscid::Connector::GetName()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00181"></a>00181 {
<a name="l00182"></a>00182     <span class="keywordflow">if</span> ( Name.<a class="code" href="class_omiscid_1_1_simple_string.html#b41ea981fc2ce4c775fe394876e05252">IsEmpty</a>() )
<a name="l00183"></a>00183     {
<a name="l00184"></a>00184         <span class="keywordflow">return</span> DefaultMsgSocketName;
<a name="l00185"></a>00185     }
<a name="l00186"></a>00186     <span class="keywordflow">return</span> Name;
<a name="l00187"></a>00187 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dcae5a3be1bbfd31d4cbbe820d68a970"></a><!-- doxytag: member="Omiscid::MsgSocket::SetCallbackSyncLink" ref="dcae5a3be1bbfd31d4cbbe820d68a970" args="(Callback_SyncLink cr, void *user_data1=NULL, void *user_data2=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MsgSocket::SetCallbackSyncLink           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket.html#755a9ab6299c74f203aec3ae5a4a4c47">Callback_SyncLink</a>&nbsp;</td>
          <td class="paramname"> <em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>user_data1</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>user_data2</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
define callback function called in receive 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cr</em>&nbsp;</td><td>the callback call on receive message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>user_data1</em>&nbsp;</td><td>pointer on data (will be found in the callback parameter) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>user_data2</em>&nbsp;</td><td>pointer on data (will be found in the callback parameter) </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00471">471</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_message_8h-source.html#l00077">Omiscid::Message::buffer</a>, <a class="el" href="_msg_socket_8h-source.html#l00396">callbackSyncLinkFct</a>, <a class="el" href="_message_8h-source.html#l00078">Omiscid::Message::len</a>, <a class="el" href="_mutex_8cpp-source.html#l00051">Omiscid::Mutex::Lock()</a>, <a class="el" href="_msg_socket_8h-source.html#l00035">Omiscid::MsgSocketCallBackData::Msg</a>, <a class="el" href="_msg_socket_8h-source.html#l00395">mutex</a>, <a class="el" href="_mutex_8cpp-source.html#l00078">Omiscid::Mutex::Unlock()</a>, <a class="el" href="_msg_socket_8h-source.html#l00036">Omiscid::MsgSocketCallBackData::userData1</a>, and <a class="el" href="_msg_socket_8h-source.html#l00037">Omiscid::MsgSocketCallBackData::userData2</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>, and <a class="el" href="_connector_8cpp-source.html#l00040">Omiscid::Connector::Create()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00472"></a>00472 {
<a name="l00473"></a>00473     <a class="code" href="class_omiscid_1_1_msg_socket.html#f8de8404f66db44e0a1beed0d48abb7f">mutex</a>.<a class="code" href="class_omiscid_1_1_mutex.html#e520c021cd6b107ba62152ad3beecd60" title="Lock the mutex.">Lock</a>();       <span class="comment">// Add SL_ as comment in order to prevent false alarm in code checker on locks</span>
<a name="l00474"></a>00474 
<a name="l00475"></a>00475     <a class="code" href="class_omiscid_1_1_msg_socket.html#eafc599eec5aca8cfeea9727bf984f46">callbackSyncLinkFct</a> = cr;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477     callbackSyncLinkData.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#8280558340d705cb00e23e2a7e46cf11">Msg</a>.<a class="code" href="class_omiscid_1_1_message.html#957b3b27097afaa7c59ac0e0812c33e9">len</a> = 0;
<a name="l00478"></a>00478     callbackSyncLinkData.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#8280558340d705cb00e23e2a7e46cf11">Msg</a>.<a class="code" href="class_omiscid_1_1_message.html#6d1fc92e7bcb8093a192605ce05ccb0c">buffer</a> = NULL;
<a name="l00479"></a>00479     callbackSyncLinkData.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#17ba8ff15c9b3774e5d87614ff90e0a1">userData1</a> = user_data1;
<a name="l00480"></a>00480     callbackSyncLinkData.<a class="code" href="class_omiscid_1_1_msg_socket_call_back_data.html#02be2c2528533e57fa4ddaf5b76a97a8">userData2</a> = user_data2;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     <a class="code" href="class_omiscid_1_1_msg_socket.html#f8de8404f66db44e0a1beed0d48abb7f">mutex</a>.<a class="code" href="class_omiscid_1_1_mutex.html#4e0f497d5902ef4d2fcee59d2f9a57a9" title="Unlock the mutex.">Unlock</a>();     <span class="comment">// Add SL_ as comment in order to prevent false alarm in code checker on locks</span>
<a name="l00483"></a>00483 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="01ceb5ec9a28d28fcf402acf5c35fbef"></a><!-- doxytag: member="Omiscid::MsgSocket::Run" ref="01ceb5ec9a28d28fcf402acf5c35fbef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FUNCTION_CALL_TYPE MsgSocket::Run           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
method call when the <a class="el" href="class_omiscid_1_1_thread.html" title="Thread Implementation.">Thread</a> is started 
<p>
According to the kind of <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> :<ul>
<li>receive the message on UDP, on TCP,</li><li>accept the connection for TCP_SERVER </li></ul>

<p>Implements <a class="el" href="class_omiscid_1_1_thread.html#9527b3c79a6302f29d0bbc774e707f53">Omiscid::Thread</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00568">568</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8cpp-source.html#l00904">AcceptConnection()</a>, <a class="el" href="_thread_8cpp-source.html#l00216">Omiscid::Thread::StopPending()</a>, <a class="el" href="_msg_socket_8h-source.html#l00147">TCP_CLIENT_KIND</a>, <a class="el" href="_msg_socket_8h-source.html#l00148">TCP_SERVER_KIND</a>, and <a class="el" href="_msg_socket_8h-source.html#l00149">UDP_EXCHANGE_KIND</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00569"></a>00569 {
<a name="l00570"></a>00570     <span class="keywordflow">switch</span> (kind)
<a name="l00571"></a>00571     {
<a name="l00572"></a>00572     <span class="keywordflow">case</span> <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b0ecdad184663d729a7c9ab6b9fcc73f5">TCP_SERVER_KIND</a>:
<a name="l00573"></a>00573         <span class="keywordflow">while</span>(connected &amp;&amp; !<a class="code" href="class_omiscid_1_1_thread.html#a045d0e2f5dd7766af501cf988b8f2a4" title="Return if stop is required.">StopPending</a>())
<a name="l00574"></a>00574         {
<a name="l00575"></a>00575             <span class="comment">//printf("MsgSocket::run : tcp_server loop\n");</span>
<a name="l00576"></a>00576             <a class="code" href="class_omiscid_1_1_msg_socket.html#626bf84517ed66dd14358ba09da0dac4" title="Accept new TCP connection.">AcceptConnection</a>();
<a name="l00577"></a>00577         }
<a name="l00578"></a>00578         <span class="keywordflow">break</span>;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580     <span class="keywordflow">case</span> <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b37eed2ba19df9c46649c797a72cc2d7f">TCP_CLIENT_KIND</a>:
<a name="l00581"></a>00581         <span class="keywordflow">while</span>(connected &amp;&amp; !<a class="code" href="class_omiscid_1_1_thread.html#a045d0e2f5dd7766af501cf988b8f2a4" title="Return if stop is required.">StopPending</a>())
<a name="l00582"></a>00582         {
<a name="l00583"></a>00583             <span class="comment">//printf("MsgSocket::run : tcp_client loop\n");</span>
<a name="l00584"></a>00584             Receive();
<a name="l00585"></a>00585         }
<a name="l00586"></a>00586         <span class="keywordflow">break</span>;
<a name="l00587"></a>00587 
<a name="l00588"></a>00588     <span class="keywordflow">case</span> <a class="code" href="class_omiscid_1_1_msg_socket.html#4d9ba56644652acfe0e4f6ade0e9659b26b29a312b497622aad9256945d6b8cb">UDP_EXCHANGE_KIND</a>:
<a name="l00589"></a>00589         <span class="keywordflow">while</span>(connected &amp;&amp; !<a class="code" href="class_omiscid_1_1_thread.html#a045d0e2f5dd7766af501cf988b8f2a4" title="Return if stop is required.">StopPending</a>())
<a name="l00590"></a>00590         {
<a name="l00591"></a>00591             ReceiveUdpExchange();
<a name="l00592"></a>00592         }
<a name="l00593"></a>00593         <span class="keywordflow">break</span>;
<a name="l00594"></a>00594 
<a name="l00595"></a>00595     <span class="keywordflow">default</span>:
<a name="l00596"></a>00596         OmiscidError( <span class="stringliteral">"run : unknown type of connection\n"</span>);
<a name="l00597"></a>00597         <span class="keywordflow">break</span>;
<a name="l00598"></a>00598     }
<a name="l00599"></a>00599 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7496fe09ce10bd84eac5ea6e44c8bc31"></a><!-- doxytag: member="Omiscid::MsgSocket::Send" ref="7496fe09ce10bd84eac5ea6e44c8bc31" args="(int len, const char *buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MsgSocket::Send           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>buf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message (on TCP) by using the BIP protocol. 
<p>
add tag around data in buf before sending them <div class="fragment"><pre class="fragment">
   * BIP/1.0 pid mid size\r\n
   * ... data ...
   * /r/n
   * </pre></div> <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>[in] number of byte to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>[in] buffer to send </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of byte send (byte of data + tag) (-1 if error occured) </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00911">911</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8h-source.html#l00392">CallbackObjects</a>, <a class="el" href="_simple_exception_8h-source.html#l00063">Omiscid::SimpleException::err</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01479">GetPeerPid()</a>, <a class="el" href="_simple_string_8cpp-source.html#l00897">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, <a class="el" href="_socket_8cpp-source.html#l00347">Omiscid::Socket::Send()</a>, and <a class="el" href="_lock_management_8cpp-source.html#l00075">Omiscid::SmartLocker::Unlock()</a>.</p>

<p>Referenced by <a class="el" href="_control_server_8cpp-source.html#l00408">Omiscid::ControlServer::ProcessAMessage()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00105">Omiscid::TcpServer::SendToAllClients()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00059">Omiscid::TcpServer::SendToClient()</a>, and <a class="el" href="_tcp_client_8cpp-source.html#l00029">Omiscid::TcpClient::SendToServer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00912"></a>00912 {
<a name="l00913"></a>00913     <span class="keywordtype">int</span> TotalLen = 0;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915     <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_protectSend(protectSend);
<a name="l00916"></a>00916     <span class="keywordflow">try</span>
<a name="l00917"></a>00917     {
<a name="l00918"></a>00918         <span class="keywordflow">if</span> ( Sendlen &gt; maxBIPMessageSize )
<a name="l00919"></a>00919         {
<a name="l00920"></a>00920             <span class="keywordtype">int</span> HeaderSend      = 0;
<a name="l00921"></a>00921             <span class="comment">// int BodySend     = 0;</span>
<a name="l00922"></a>00922             <span class="keywordtype">int</span> TailerSend      = 0;
<a name="l00923"></a>00923             <span class="comment">// int ResSend              = 0;</span>
<a name="l00924"></a>00924 
<a name="l00925"></a>00925             <span class="comment">// OmiscidTrace( "Message too big for one TCP frame (size=%d, sizemax=%d) sends many.\n", Sendlen, maxMessageSizeForTCP);</span>
<a name="l00926"></a>00926             TotalLen = PrepareBufferForBip( (<span class="keywordtype">char</span>*)SendBuffer, NULL, Sendlen, <span class="keyword">true</span> );
<a name="l00927"></a>00927             <span class="keywordflow">if</span> ( TotalLen == -1 )
<a name="l00928"></a>00928             {
<a name="l00929"></a>00929                 SL_protectSend.Unlock();
<a name="l00930"></a>00930                 <span class="keywordflow">return</span> -1;
<a name="l00931"></a>00931             }
<a name="l00932"></a>00932 
<a name="l00933"></a>00933             <span class="comment">// We complete the header</span>
<a name="l00934"></a>00934             WriteHeaderForBip( (<span class="keywordtype">char</span>*)SendBuffer, service_id, message_id );
<a name="l00935"></a>00935 
<a name="l00936"></a>00936             <span class="comment">// Increase the number for the next message</span>
<a name="l00937"></a>00937             message_id++;
<a name="l00938"></a>00938 
<a name="l00939"></a>00939             <span class="comment">// Send header</span>
<a name="l00940"></a>00940             HeaderSend = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>(TotalLen, (<span class="keywordtype">char</span>*)SendBuffer);
<a name="l00941"></a>00941             <span class="keywordflow">if</span> ( HeaderSend != TotalLen )
<a name="l00942"></a>00942             {
<a name="l00943"></a>00943                 <span class="keywordflow">return</span> -1;
<a name="l00944"></a>00944             }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946             <span class="comment">// Let's send data...</span>
<a name="l00947"></a>00947             TotalLen = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>( Sendlen, (<span class="keywordtype">char</span>*)(buf) );
<a name="l00948"></a>00948             <span class="keywordflow">if</span> ( TotalLen != Sendlen )
<a name="l00949"></a>00949             {
<a name="l00950"></a>00950                 <span class="keywordflow">return</span> -1;
<a name="l00951"></a>00951             }
<a name="l00952"></a>00952 
<a name="l00953"></a>00953             TailerSend = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>( tag_end_size, tag_end );
<a name="l00954"></a>00954             <span class="keywordflow">if</span> ( TailerSend != tag_end_size )
<a name="l00955"></a>00955             {
<a name="l00956"></a>00956                 <span class="keywordflow">return</span> -1;
<a name="l00957"></a>00957             }
<a name="l00958"></a>00958 
<a name="l00959"></a>00959             <span class="keywordflow">return</span> HeaderSend + TotalLen + TailerSend;
<a name="l00960"></a>00960         }
<a name="l00961"></a>00961 
<a name="l00962"></a>00962         TotalLen = PrepareBufferForBip( (<span class="keywordtype">char</span>*)SendBuffer, buf, Sendlen );
<a name="l00963"></a>00963         <span class="keywordflow">if</span> ( TotalLen == -1 )
<a name="l00964"></a>00964         {
<a name="l00965"></a>00965             <span class="keywordflow">return</span> -1;
<a name="l00966"></a>00966         }
<a name="l00967"></a>00967 
<a name="l00968"></a>00968         <span class="comment">// We complete the header</span>
<a name="l00969"></a>00969         WriteHeaderForBip( (<span class="keywordtype">char</span>*)SendBuffer, service_id, message_id );
<a name="l00970"></a>00970 
<a name="l00971"></a>00971         <span class="comment">// Increase the number for the next message</span>
<a name="l00972"></a>00972         message_id++;
<a name="l00973"></a>00973 
<a name="l00974"></a>00974         <span class="comment">// if ( (TotalLen = socket-&gt;Send(TotalLen, (char*)SendBuffer)) == -1)</span>
<a name="l00975"></a>00975         <span class="comment">// {</span>
<a name="l00976"></a>00976         <span class="comment">//      TotalLen = -1;</span>
<a name="l00977"></a>00977         <span class="comment">//}</span>
<a name="l00978"></a>00978         TotalLen = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>(TotalLen, (<span class="keywordtype">char</span>*)SendBuffer);
<a name="l00979"></a>00979 
<a name="l00980"></a>00980 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00981"></a>00981 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( Debug &amp; DBG_SEND )
<a name="l00982"></a>00982         {
<a name="l00983"></a>00983             SendBuffer[TotalLen] = <span class="charliteral">'\0'</span>;
<a name="l00984"></a>00984             fprintf( stderr, <span class="stringliteral">"MsgSocket::Send: %s (%d)\n"</span>, SendBuffer, TotalLen );
<a name="l00985"></a>00985         }
<a name="l00986"></a>00986 <span class="preprocessor">#endif</span>
<a name="l00987"></a>00987 <span class="preprocessor"></span>
<a name="l00988"></a>00988         SL_protectSend.Unlock();
<a name="l00989"></a>00989         <span class="keywordflow">return</span> (TotalLen-tag_end_size-tag_size);
<a name="l00990"></a>00990     }
<a name="l00991"></a>00991     <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp; e)
<a name="l00992"></a>00992     {
<a name="l00993"></a>00993         OmiscidTrace( <span class="stringliteral">"SocketException: %s %d\n"</span>, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#c4a307138a16850413564c3dc7103ea9">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#25a4d280190281495a5f85fa4dca1319">err</a>);
<a name="l00994"></a>00994         <span class="keywordflow">if</span> ( connected )
<a name="l00995"></a>00995         {
<a name="l00996"></a>00996             <span class="comment">// Send disconnected message</span>
<a name="l00997"></a>00997             <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>);
<a name="l00998"></a>00998             <span class="comment">// Send info to all listener</span>
<a name="l00999"></a>00999             <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Next() )
<a name="l01000"></a>01000             {
<a name="l01001"></a>01001                 <span class="keywordflow">try</span>
<a name="l01002"></a>01002                 {
<a name="l01003"></a>01003                     <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.GetCurrent()-&gt;Disconnected(*<span class="keyword">this</span>,<a class="code" href="class_omiscid_1_1_msg_socket.html#11758f2a2dd4bb671849cb1856ee9a91">GetPeerPid</a>());
<a name="l01004"></a>01004                 }
<a name="l01005"></a>01005                 <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp;) {}      <span class="comment">// Discard it...</span>
<a name="l01006"></a>01006             }
<a name="l01007"></a>01007             connected = <span class="keyword">false</span>;
<a name="l01008"></a>01008         }
<a name="l01009"></a>01009         <span class="keywordflow">return</span> -1;
<a name="l01010"></a>01010     }
<a name="l01011"></a>01011 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b80c9ed1145f7d4e42240f6b8de09c0f"></a><!-- doxytag: member="Omiscid::MsgSocket::SendPreparedBuffer" ref="b80c9ed1145f7d4e42240f6b8de09c0f" args="(int len, char *buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MsgSocket::SendPreparedBuffer           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a preformated BIP message (on TCP) by using the BIP protocol. 
<p>
add tag at the bigning of buf and send it <div class="fragment"><pre class="fragment">
   * BIP/1.0 pid mid size\r\n
   * ... data ...
   * /r/n
   * </pre></div> <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>[in] number of byte to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>[in,out] buffer to modify and send </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of byte send (byte of data + tag) (-1 if error occured) </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01129">1129</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8h-source.html#l00392">CallbackObjects</a>, <a class="el" href="_simple_exception_8h-source.html#l00063">Omiscid::SimpleException::err</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01479">GetPeerPid()</a>, <a class="el" href="_simple_string_8cpp-source.html#l00897">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, and <a class="el" href="_socket_8cpp-source.html#l00347">Omiscid::Socket::Send()</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00105">Omiscid::TcpServer::SendToAllClients()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01130"></a>01130 {
<a name="l01131"></a>01131     <span class="keywordflow">if</span>(l_buffer == NULL)
<a name="l01132"></a>01132     {
<a name="l01133"></a>01133         OmiscidError( <span class="stringliteral">"SendPreparedBuffer : NULL mesg\n"</span> );
<a name="l01134"></a>01134         <span class="keywordflow">throw</span> <a class="code" href="class_omiscid_1_1_msg_socket_exception.html" title="Exception thrown by the class MsgSocket.">MsgSocketException</a>(<span class="stringliteral">"Message NULL for TCP"</span>);
<a name="l01135"></a>01135     }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137     <span class="keywordflow">if</span>(len &gt; maxMessageSizeForTCP)
<a name="l01138"></a>01138     {
<a name="l01139"></a>01139         OmiscidError( <span class="stringliteral">"Message too big for TCP (size=%d, sizemax=%d) so not sended.\n"</span>, len, maxMessageSizeForTCP);
<a name="l01140"></a>01140         <span class="keywordflow">throw</span> <a class="code" href="class_omiscid_1_1_msg_socket_exception.html" title="Exception thrown by the class MsgSocket.">MsgSocketException</a>(<span class="stringliteral">"Message too big for TCP"</span>);
<a name="l01141"></a>01141     }
<a name="l01142"></a>01142 
<a name="l01143"></a>01143     <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_protectSend(protectSend);
<a name="l01144"></a>01144     <span class="keywordflow">try</span>
<a name="l01145"></a>01145     {
<a name="l01146"></a>01146         <span class="comment">// Here we've got a full buffer and we can (must) write our header at the in at the beginning !</span>
<a name="l01147"></a>01147         WriteHeaderForBip(l_buffer, service_id, message_id );
<a name="l01148"></a>01148 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01149"></a>01149 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( Debug &amp; DBG_SEND )
<a name="l01150"></a>01150         {
<a name="l01151"></a>01151             OmiscidTrace( <span class="stringliteral">"MsgSocket::SendPreparedBuffer %s\n"</span>, l_buffer );
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153 <span class="preprocessor">#endif</span>
<a name="l01154"></a>01154 <span class="preprocessor"></span>
<a name="l01155"></a>01155         message_id++;
<a name="l01156"></a>01156 
<a name="l01157"></a>01157         <span class="comment">//socket-&gt;Send(strlen(start_tag), start_tag);</span>
<a name="l01158"></a>01158         <span class="keywordtype">int</span> res;
<a name="l01159"></a>01159         <span class="keywordflow">if</span>((res = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>(len, l_buffer)) != -1)
<a name="l01160"></a>01160         {
<a name="l01161"></a>01161             <span class="keywordflow">return</span> res;
<a name="l01162"></a>01162         }
<a name="l01163"></a>01163         OmiscidTrace( <span class="stringliteral">"Erreur Send (-1)\n"</span> );
<a name="l01164"></a>01164         <span class="keywordflow">return</span> -1;
<a name="l01165"></a>01165 
<a name="l01166"></a>01166     }
<a name="l01167"></a>01167     <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp; e)
<a name="l01168"></a>01168     {
<a name="l01169"></a>01169         OmiscidTrace( <span class="stringliteral">"SocketException: %s %d\n"</span>, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#c4a307138a16850413564c3dc7103ea9">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#25a4d280190281495a5f85fa4dca1319">err</a>);
<a name="l01170"></a>01170         <span class="keywordflow">if</span> ( connected )
<a name="l01171"></a>01171         {
<a name="l01172"></a>01172             <span class="comment">// Send disconnected message</span>
<a name="l01173"></a>01173             <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>);
<a name="l01174"></a>01174             <span class="comment">// Send info to all listener</span>
<a name="l01175"></a>01175             <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Next() )
<a name="l01176"></a>01176             {
<a name="l01177"></a>01177                 <span class="keywordflow">try</span>
<a name="l01178"></a>01178                 {
<a name="l01179"></a>01179                     <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.GetCurrent()-&gt;Disconnected(*<span class="keyword">this</span>, <a class="code" href="class_omiscid_1_1_msg_socket.html#11758f2a2dd4bb671849cb1856ee9a91">GetPeerPid</a>());
<a name="l01180"></a>01180                 }
<a name="l01181"></a>01181                 <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp;) {} <span class="comment">// Discard it</span>
<a name="l01182"></a>01182             }
<a name="l01183"></a>01183             connected = <span class="keyword">false</span>;
<a name="l01184"></a>01184         }
<a name="l01185"></a>01185         <span class="keywordflow">return</span> -1;
<a name="l01186"></a>01186     }
<a name="l01187"></a>01187 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4a2314b70a47858c24edbaa8636bcbe6"></a><!-- doxytag: member="Omiscid::MsgSocket::SendCuttedMsg" ref="4a2314b70a47858c24edbaa8636bcbe6" args="(int *tab_len, const char **tab_buf, int nb_buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MsgSocket::SendCuttedMsg           </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>tab_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>tab_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nb_buf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message in several part (on TCP) by using the BIP protocol. 
<p>
The parts of the message are sent the one per one, the all message is put between BIP tag. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tab_len</em>&nbsp;</td><td>[in] array of buffer size : the size of each buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tab_buf</em>&nbsp;</td><td>[in] array of buffer : the buffers to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb_buf</em>&nbsp;</td><td>[in] the number of buffer to send : the number of buffer in the array </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of byte send (byte of data + tag) (-1 if error occured) </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01013">1013</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8h-source.html#l00392">CallbackObjects</a>, <a class="el" href="_simple_exception_8h-source.html#l00063">Omiscid::SimpleException::err</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01479">GetPeerPid()</a>, <a class="el" href="_simple_string_8cpp-source.html#l00897">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, <a class="el" href="_socket_8cpp-source.html#l00347">Omiscid::Socket::Send()</a>, <a class="el" href="_config_system_8h-source.html#l00145">SOCKET_ERROR</a>, and <a class="el" href="_lock_management_8cpp-source.html#l00075">Omiscid::SmartLocker::Unlock()</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00180">Omiscid::TcpServer::SendToAllClients()</a>, and <a class="el" href="_tcp_server_8cpp-source.html#l00082">Omiscid::TcpServer::SendToClient()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01014"></a>01014 {
<a name="l01015"></a>01015     <span class="keywordtype">int</span> i;
<a name="l01016"></a>01016     <span class="keywordtype">int</span> SendLen;
<a name="l01017"></a>01017     <span class="keywordtype">int</span> TotalLen;
<a name="l01018"></a>01018 
<a name="l01019"></a>01019     <span class="comment">// Compute the len of all buffers</span>
<a name="l01020"></a>01020     <span class="keywordflow">for</span>( SendLen = 0, i = 0; i &lt; nb_buf; i ++ )
<a name="l01021"></a>01021     {
<a name="l01022"></a>01022         SendLen += tab_length[i];
<a name="l01023"></a>01023     }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025     <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_protectSend(protectSend);
<a name="l01026"></a>01026     <span class="keywordflow">try</span>
<a name="l01027"></a>01027     {
<a name="l01028"></a>01028         <span class="keywordflow">if</span> ( SendLen &gt; maxBIPMessageSize )
<a name="l01029"></a>01029         {
<a name="l01030"></a>01030             <span class="keywordtype">int</span> HeaderSend      = 0;
<a name="l01031"></a>01031             <span class="keywordtype">int</span> BodySend        = 0;
<a name="l01032"></a>01032             <span class="keywordtype">int</span> TailerSend      = 0;
<a name="l01033"></a>01033             <span class="comment">// int ResSend              = 0;</span>
<a name="l01034"></a>01034 
<a name="l01035"></a>01035             <span class="comment">// OmiscidTrace( "Message too big for one TCP frame (size=%d, sizemax=%d) sends many.\n", SendLen, maxMessageSizeForTCP);</span>
<a name="l01036"></a>01036 
<a name="l01037"></a>01037             <span class="comment">// prepare buffer</span>
<a name="l01038"></a>01038             TotalLen = PrepareBufferForBip( (<span class="keywordtype">char</span>*)SendBuffer, NULL, SendLen, <span class="keyword">true</span> );
<a name="l01039"></a>01039             <span class="keywordflow">if</span> ( TotalLen == -1 )
<a name="l01040"></a>01040             {
<a name="l01041"></a>01041                 <span class="keywordflow">return</span> -1;
<a name="l01042"></a>01042             }
<a name="l01043"></a>01043 
<a name="l01044"></a>01044             <span class="comment">// We complete the header</span>
<a name="l01045"></a>01045             WriteHeaderForBip( (<span class="keywordtype">char</span>*)SendBuffer, service_id, message_id );
<a name="l01046"></a>01046 
<a name="l01047"></a>01047             <span class="comment">// Increase the number for the next message</span>
<a name="l01048"></a>01048             message_id++;
<a name="l01049"></a>01049 
<a name="l01050"></a>01050             <span class="comment">// Send header</span>
<a name="l01051"></a>01051             HeaderSend = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>(TotalLen, (<span class="keywordtype">char</span>*)SendBuffer);
<a name="l01052"></a>01052 
<a name="l01053"></a>01053             <span class="keywordflow">if</span> ( HeaderSend != TotalLen )
<a name="l01054"></a>01054             {
<a name="l01055"></a>01055                 <span class="keywordflow">return</span> -1;
<a name="l01056"></a>01056             }
<a name="l01057"></a>01057 
<a name="l01058"></a>01058             <span class="comment">// Send all parts of the message</span>
<a name="l01059"></a>01059             <span class="keywordflow">for</span>( i = 0; i &lt; nb_buf; i ++ )
<a name="l01060"></a>01060             {
<a name="l01061"></a>01061                 TotalLen = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>( tab_length[i], tab_buf[i] );
<a name="l01062"></a>01062 
<a name="l01063"></a>01063                 <span class="keywordflow">if</span> ( TotalLen == <a class="code" href="group___system.html#g633b0396ff93d336a088412a190a5072" title="Define the socket error symbol as on WIN32 plateform.">SOCKET_ERROR</a> )
<a name="l01064"></a>01064                 {
<a name="l01065"></a>01065                     <span class="keywordflow">return</span> -1;
<a name="l01066"></a>01066                 }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068                 BodySend += TotalLen;
<a name="l01069"></a>01069             }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071             <span class="comment">// Send end of the message</span>
<a name="l01072"></a>01072             TailerSend = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>( tag_end_size, tag_end );
<a name="l01073"></a>01073             <span class="keywordflow">if</span> ( TailerSend == -1 )
<a name="l01074"></a>01074             {
<a name="l01075"></a>01075                 <span class="keywordflow">return</span> -1;
<a name="l01076"></a>01076             }
<a name="l01077"></a>01077 
<a name="l01078"></a>01078             <span class="keywordflow">return</span> HeaderSend + BodySend + TailerSend;
<a name="l01079"></a>01079         }
<a name="l01080"></a>01080 
<a name="l01081"></a>01081 
<a name="l01082"></a>01082         TotalLen = PrepareBufferForBipFromCuttedMsg( (<span class="keywordtype">char</span>*)SendBuffer, tab_length, tab_buf, nb_buf);
<a name="l01083"></a>01083         <span class="keywordflow">if</span> ( TotalLen == -1 )
<a name="l01084"></a>01084         {
<a name="l01085"></a>01085             <span class="keywordflow">return</span> -1;
<a name="l01086"></a>01086         }
<a name="l01087"></a>01087         <span class="comment">// We complete the header</span>
<a name="l01088"></a>01088         WriteHeaderForBip( (<span class="keywordtype">char</span>*)SendBuffer, service_id, message_id );
<a name="l01089"></a>01089 
<a name="l01090"></a>01090 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01091"></a>01091 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( Debug &amp; DBG_SEND )
<a name="l01092"></a>01092         {
<a name="l01093"></a>01093             OmiscidTrace( <span class="stringliteral">"MsgSocket::SendPreparedBuffer %s\n"</span>, SendBuffer );
<a name="l01094"></a>01094         }
<a name="l01095"></a>01095 <span class="preprocessor">#endif</span>
<a name="l01096"></a>01096 <span class="preprocessor"></span>
<a name="l01097"></a>01097         <span class="comment">// Increase the number for the next message</span>
<a name="l01098"></a>01098         ++message_id;
<a name="l01099"></a>01099 
<a name="l01100"></a>01100         <span class="keywordflow">if</span> ( (TotalLen = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#97f88b33e0a6288cb8b1a86e8ead640c" title="Send a buffer of byte.">Send</a>(TotalLen, (<span class="keywordtype">char</span>*)SendBuffer)) == -1)
<a name="l01101"></a>01101         {
<a name="l01102"></a>01102             TotalLen = -1;
<a name="l01103"></a>01103         }
<a name="l01104"></a>01104         <span class="keywordflow">return</span> TotalLen;
<a name="l01105"></a>01105     }
<a name="l01106"></a>01106     <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp; e)
<a name="l01107"></a>01107     {
<a name="l01108"></a>01108         OmiscidTrace( <span class="stringliteral">"SocketException: %s %d\n"</span>, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#c4a307138a16850413564c3dc7103ea9">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#25a4d280190281495a5f85fa4dca1319">err</a>);
<a name="l01109"></a>01109         <span class="keywordflow">if</span> ( connected )
<a name="l01110"></a>01110         {
<a name="l01111"></a>01111             <span class="comment">// Send disconnected message</span>
<a name="l01112"></a>01112             <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>);
<a name="l01113"></a>01113             <span class="comment">// Send info to all listener</span>
<a name="l01114"></a>01114             <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Next() )
<a name="l01115"></a>01115             {
<a name="l01116"></a>01116                 <span class="keywordflow">try</span>
<a name="l01117"></a>01117                 {
<a name="l01118"></a>01118                     <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.GetCurrent()-&gt;Disconnected(*<span class="keyword">this</span>, <a class="code" href="class_omiscid_1_1_msg_socket.html#11758f2a2dd4bb671849cb1856ee9a91">GetPeerPid</a>());
<a name="l01119"></a>01119                 }
<a name="l01120"></a>01120                 <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp;) {} <span class="comment">// Discard it</span>
<a name="l01121"></a>01121             }
<a name="l01122"></a>01122             connected = <span class="keyword">false</span>;
<a name="l01123"></a>01123         }
<a name="l01124"></a>01124         SL_protectSend.Unlock();
<a name="l01125"></a>01125         <span class="keywordflow">return</span> -1;
<a name="l01126"></a>01126     }
<a name="l01127"></a>01127 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5c449b68e25f5cf173d0a69a699a975b"></a><!-- doxytag: member="Omiscid::MsgSocket::SendTo" ref="5c449b68e25f5cf173d0a69a699a975b" args="(int len, const char *buf, UdpConnection *udp_dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MsgSocket::SendTo           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> *&nbsp;</td>
          <td class="paramname"> <em>udp_dest</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message (on UDP) by using BIP protocol <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>[in] number of byte to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>[in] buffer to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_dest</em>&nbsp;</td><td>[in] the destination for the message </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of byte send (-1 if error occured) </dd></dl>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_udp_exchange.html#e41aa7e950ccad40424e0a98d557d637">Omiscid::UdpExchange</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01189">1189</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8h-source.html#l00083">Omiscid::UdpConnection::addr</a>, <a class="el" href="_msg_socket_8h-source.html#l00392">CallbackObjects</a>, <a class="el" href="_simple_exception_8h-source.html#l00063">Omiscid::SimpleException::err</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01479">GetPeerPid()</a>, <a class="el" href="_simple_string_8cpp-source.html#l00897">Omiscid::SimpleString::GetStr()</a>, <a class="el" href="_simple_exception_8h-source.html#l00062">Omiscid::SimpleException::msg</a>, and <a class="el" href="_socket_8cpp-source.html#l00405">Omiscid::Socket::SendTo()</a>.</p>

<p>Referenced by <a class="el" href="_udp_exchange_8cpp-source.html#l00049">Omiscid::UdpExchange::SendTo()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01190"></a>01190 {
<a name="l01191"></a>01191     <span class="comment">//   OmiscidTrace( "in MsgSocket::SendTo\n");</span>
<a name="l01192"></a>01192     <span class="comment">//   OmiscidTrace( "send to pid : %u\n", dest-&gt;pid);</span>
<a name="l01193"></a>01193     <span class="keywordflow">if</span>(len &gt; UDP_MAX_MSG_SIZE){
<a name="l01194"></a>01194         OmiscidError( <span class="stringliteral">"Message too big for UDP size=%d,  sizemax=%d\n"</span>, len, UDP_MAX_MSG_SIZE);
<a name="l01195"></a>01195         <span class="keywordflow">throw</span> <a class="code" href="class_omiscid_1_1_msg_socket_exception.html" title="Exception thrown by the class MsgSocket.">MsgSocketException</a>(<span class="stringliteral">"Message too big for UDP"</span>);
<a name="l01196"></a>01196     }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198     <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_protectSend(protectSend);
<a name="l01199"></a>01199     <span class="keywordflow">if</span> ( buffer_udp_send == NULL )
<a name="l01200"></a>01200     {
<a name="l01201"></a>01201         buffer_udp_send = <span class="keyword">new</span> OMISCID_TLM <span class="keywordtype">char</span>[UDP_MAX_MSG_SIZE+1];     <span class="comment">// +1 for '\0'</span>
<a name="l01202"></a>01202         <span class="keywordflow">if</span> ( buffer_udp_send == NULL )
<a name="l01203"></a>01203         {
<a name="l01204"></a>01204             <span class="keywordflow">return</span> 0;
<a name="l01205"></a>01205         }
<a name="l01206"></a>01206     }
<a name="l01207"></a>01207     <span class="keywordflow">try</span>
<a name="l01208"></a>01208     {
<a name="l01209"></a>01209         <span class="keyword">struct </span>sockaddr_in* destptr = &amp;(dest-&gt;addr);
<a name="l01210"></a>01210 
<a name="l01211"></a>01211         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> total = tag_size+len+tag_end_size;
<a name="l01212"></a>01212 
<a name="l01213"></a>01213         sprintf(buffer_udp_send, tag_str, service_id, message_id, len);
<a name="l01214"></a>01214         ++message_id;
<a name="l01215"></a>01215         sprintf((buffer_udp_send+total-tag_end_size), tag_end);
<a name="l01216"></a>01216         memcpy(buffer_udp_send+tag_size, buf, len);
<a name="l01217"></a>01217 
<a name="l01218"></a>01218         <span class="keywordtype">int</span> TotalLen = socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#325ef1bedf42b839bec08d776905e05e" title="Send a buffer of byte to a destination (for datagram).">SendTo</a>(total, buffer_udp_send, destptr);
<a name="l01219"></a>01219         <span class="keywordflow">return</span> TotalLen;
<a name="l01220"></a>01220 
<a name="l01221"></a>01221         <span class="comment">//        socket-&gt;SendTo(strlen(start_tag), start_tag, destptr);</span>
<a name="l01222"></a>01222         <span class="comment">//        socket-&gt;SendTo(len, buf, destptr);</span>
<a name="l01223"></a>01223         <span class="comment">//        socket-&gt;SendTo(tag_end_size, tag_end, destptr);</span>
<a name="l01224"></a>01224     }
<a name="l01225"></a>01225     <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp; e)
<a name="l01226"></a>01226     {
<a name="l01227"></a>01227         OmiscidTrace( <span class="stringliteral">"SocketException: %s %d \n"</span>, e.<a class="code" href="class_omiscid_1_1_simple_exception.html#bf3693dcd188f280e72bc861c19188bb">msg</a>.<a class="code" href="class_omiscid_1_1_simple_string.html#c4a307138a16850413564c3dc7103ea9">GetStr</a>(), e.<a class="code" href="class_omiscid_1_1_simple_exception.html#25a4d280190281495a5f85fa4dca1319">err</a>);
<a name="l01228"></a>01228         <span class="keywordflow">if</span> ( connected )
<a name="l01229"></a>01229         {
<a name="l01230"></a>01230             <span class="comment">// Send disconnected message</span>
<a name="l01231"></a>01231             <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>);
<a name="l01232"></a>01232             <span class="comment">// Send info to all listener</span>
<a name="l01233"></a>01233             <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Next() )
<a name="l01234"></a>01234             {
<a name="l01235"></a>01235                 <span class="keywordflow">try</span>
<a name="l01236"></a>01236                 {
<a name="l01237"></a>01237                     <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.GetCurrent()-&gt;Disconnected(*<span class="keyword">this</span>,<a class="code" href="class_omiscid_1_1_msg_socket.html#11758f2a2dd4bb671849cb1856ee9a91">GetPeerPid</a>());
<a name="l01238"></a>01238                 }
<a name="l01239"></a>01239                 <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp;) {} <span class="comment">// Discard it</span>
<a name="l01240"></a>01240             }
<a name="l01241"></a>01241             connected = <span class="keyword">false</span>;
<a name="l01242"></a>01242         }
<a name="l01243"></a>01243         <span class="keywordflow">return</span> -1;
<a name="l01244"></a>01244     }
<a name="l01245"></a>01245 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="66d6616574ad4f410e424a1e12fe1106"></a><!-- doxytag: member="Omiscid::MsgSocket::GetSocket" ref="66d6616574ad4f410e424a1e12fe1106" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_socket.html">Socket</a> * MsgSocket::GetSocket           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the socket object. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> object used by this <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> object </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01459">1459</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_udp_exchange_8cpp-source.html#l00043">Omiscid::UdpExchange::Close()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00053">Omiscid::TcpServer::Close()</a>, and <a class="el" href="_control_server_8cpp-source.html#l00173">Omiscid::ControlServer::StartServer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01460"></a>01460 {
<a name="l01461"></a>01461     <span class="keywordflow">return</span> socket;
<a name="l01462"></a>01462 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="abc7fca62eb753cff2f578a4fbbdfa79"></a><!-- doxytag: member="Omiscid::MsgSocket::GetPortNb" ref="abc7fca62eb753cff2f578a4fbbdfa79" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short MsgSocket::GetPortNb           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to Port number. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the port number where the socket listen </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01444">1444</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_socket_8cpp-source.html#l00465">Omiscid::Socket::GetPortNb()</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00573">Omiscid::TcpServer::GetTcpPort()</a>, and <a class="el" href="_udp_exchange_8cpp-source.html#l00253">Omiscid::UdpExchange::GetUdpPort()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01445"></a>01445 {
<a name="l01446"></a>01446     <span class="keywordflow">return</span> socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#edce8a71802b89e05c32951570befbc5" title="Access to the port number.">GetPortNb</a>();
<a name="l01447"></a>01447 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="643130a0e78dc5780e41571149ffb31c"></a><!-- doxytag: member="Omiscid::MsgSocket::IsConnected" ref="643130a0e78dc5780e41571149ffb31c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::IsConnected           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Test if the <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> is in usage. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>false if this object is no more useful (no more connected) </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01464">1464</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_connector_8cpp-source.html#l00414">Omiscid::Connector::AcceptConnection()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00331">Omiscid::TcpServer::AddCallbackObject()</a>, <a class="el" href="_service_proxy_8cpp-source.html#l00543">Omiscid::ServiceProxy::AddRemoteVariableChangeListener()</a>, <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00515">Omiscid::TcpServer::DisconnectPeerId()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00474">Omiscid::TcpServer::FindClientFromId()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00407">Omiscid::TcpServer::GetListPeerId()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00262">Omiscid::TcpServer::GetNbConnections()</a>, <a class="el" href="_service_proxy_8cpp-source.html#l00499">Omiscid::ServiceProxy::GetVariableDescription()</a>, <a class="el" href="_service_proxy_8cpp-source.html#l00455">Omiscid::ServiceProxy::GetVariableType()</a>, <a class="el" href="_service_proxy_8cpp-source.html#l00409">Omiscid::ServiceProxy::GetVariableValue()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00386">Omiscid::TcpServer::RemoveAllCallbackObjects()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00357">Omiscid::TcpServer::RemoveCallbackObject()</a>, <a class="el" href="_service_proxy_8cpp-source.html#l00592">Omiscid::ServiceProxy::RemoveRemoteVariableChangeListener()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00105">Omiscid::TcpServer::SendToAllClients()</a>, <a class="el" href="_service_proxy_8cpp-source.html#l00379">Omiscid::ServiceProxy::SetVariableValue()</a>, and <a class="el" href="_service_proxy_8cpp-source.html#l00304">Omiscid::ServiceProxy::UpdateDescription()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01465"></a>01465 {
<a name="l01466"></a>01466     <span class="keywordflow">return</span> connected;
<a name="l01467"></a>01467 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="36d29279121e5b48c35df617c095734b"></a><!-- doxytag: member="Omiscid::MsgSocket::Stop" ref="36d29279121e5b48c35df617c095734b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MsgSocket::Stop           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stop the <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a>. 
<p>
stop the thread used for reception, or to accept connection and set the <a class="el" href="class_omiscid_1_1_msg_socket.html" title="Socket with an implementation of Basic Interconnection Protocol to exchange message...">MsgSocket</a> as disconnected 
<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00601">601</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8h-source.html#l00392">CallbackObjects</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01479">GetPeerPid()</a>, and <a class="el" href="_thread_8cpp-source.html#l00112">Omiscid::Thread::StopThread()</a>.</p>

<p>Referenced by <a class="el" href="_udp_exchange_8cpp-source.html#l00043">Omiscid::UdpExchange::Close()</a>, <a class="el" href="_connector_8cpp-source.html#l00029">Omiscid::Connector::~Connector()</a>, <a class="el" href="_control_client_8cpp-source.html#l00300">Omiscid::ControlClient::~ControlClient()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l00139">~MsgSocket()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00602"></a>00602 {
<a name="l00603"></a>00603     <span class="keywordflow">if</span> ( connected )
<a name="l00604"></a>00604     {
<a name="l00605"></a>00605         <span class="comment">// Send disconnected message</span>
<a name="l00606"></a>00606         <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_CallbackObjects(<a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>);
<a name="l00607"></a>00607         <span class="comment">// Send info to all listener</span>
<a name="l00608"></a>00608         <span class="keywordflow">for</span>( <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.First(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.NotAtEnd(); <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.Next() )
<a name="l00609"></a>00609         {
<a name="l00610"></a>00610             <span class="keywordflow">try</span>
<a name="l00611"></a>00611             {
<a name="l00612"></a>00612                 <a class="code" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">CallbackObjects</a>.GetCurrent()-&gt;Disconnected(*<span class="keyword">this</span>, <a class="code" href="class_omiscid_1_1_msg_socket.html#11758f2a2dd4bb671849cb1856ee9a91">GetPeerPid</a>());
<a name="l00613"></a>00613             }
<a name="l00614"></a>00614             <span class="keywordflow">catch</span>(<a class="code" href="class_omiscid_1_1_socket_exception.html" title="Exception thrown by the class Socket.">SocketException</a>&amp;) {} <span class="comment">// Discard it</span>
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616         connected = <span class="keyword">false</span>;
<a name="l00617"></a>00617     }
<a name="l00618"></a>00618     <a class="code" href="class_omiscid_1_1_thread.html#904f3d716a910c28bb28833a9f575832" title="Stop the thread.">Thread::StopThread</a>(0);
<a name="l00619"></a>00619 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7567f7b5736b8363e464cec76a978276"></a><!-- doxytag: member="Omiscid::MsgSocket::SetServiceId" ref="7567f7b5736b8363e464cec76a978276" args="(unsigned int pid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MsgSocket::SetServiceId           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>pid</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the service Id. 
<p>
Define the id used by the BIP protocol to identifies peer in message exchange 
<p>Reimplemented in <a class="el" href="class_omiscid_1_1_connector.html#f08cf8ae1470bc37400406a97938feb5">Omiscid::Connector</a>, <a class="el" href="class_omiscid_1_1_tcp_client.html#63530c7269bc484f39cdda729bf4e8c3">Omiscid::TcpClient</a>, <a class="el" href="class_omiscid_1_1_tcp_server.html#6843802ccb0192190d48ebb5b3a2efb8">Omiscid::TcpServer</a>, and <a class="el" href="class_omiscid_1_1_udp_exchange.html#0eef33ee246d7dd66736ceb9552e92f4">Omiscid::UdpExchange</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01469">1469</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, <a class="el" href="_udp_exchange_8cpp-source.html#l00225">Omiscid::UdpExchange::SetServiceId()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00430">Omiscid::TcpServer::SetServiceId()</a>, and <a class="el" href="_tcp_client_8cpp-source.html#l00034">Omiscid::TcpClient::SetServiceId()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01470"></a>01470 {
<a name="l01471"></a>01471     service_id = pid;
<a name="l01472"></a>01472 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c462f84f6ce4bf81a07af2a07513a3c1"></a><!-- doxytag: member="Omiscid::MsgSocket::GetServiceId" ref="c462f84f6ce4bf81a07af2a07513a3c1" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int MsgSocket::GetServiceId           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Access to the service Id. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the service id </dd></dl>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_connector.html#bdfed05c66557fe06690478fa51ea119">Omiscid::Connector</a>, <a class="el" href="class_omiscid_1_1_tcp_client.html#f8fd00b176887f718995949ff8f60b59">Omiscid::TcpClient</a>, <a class="el" href="class_omiscid_1_1_tcp_server.html#b09fd0870a17dde9afc671085b8f082f">Omiscid::TcpServer</a>, <a class="el" href="class_omiscid_1_1_udp_exchange.html#1b2c0f40387b81e5c9d7a66735c38a50">Omiscid::UdpExchange</a>, and <a class="el" href="class_omiscid_1_1_control_server.html#32c79d9b79eadee366a9ed07820d4ec1">Omiscid::ControlServer</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01474">1474</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_udp_exchange_8cpp-source.html#l00243">Omiscid::UdpExchange::GetServiceId()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00568">Omiscid::TcpServer::GetServiceId()</a>, and <a class="el" href="_tcp_client_8cpp-source.html#l00052">Omiscid::TcpClient::GetServiceId()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01475"></a>01475 {
<a name="l01476"></a>01476     <span class="keywordflow">return</span> service_id;
<a name="l01477"></a>01477 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="11758f2a2dd4bb671849cb1856ee9a91"></a><!-- doxytag: member="Omiscid::MsgSocket::GetPeerPid" ref="11758f2a2dd4bb671849cb1856ee9a91" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int MsgSocket::GetPeerPid           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the peer id : the service id of the other extremity of the socket </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01479">1479</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_connector_8cpp-source.html#l00414">Omiscid::Connector::AcceptConnection()</a>, <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00515">Omiscid::TcpServer::DisconnectPeerId()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00474">Omiscid::TcpServer::FindClientFromId()</a>, <a class="el" href="_tcp_server_8cpp-source.html#l00407">Omiscid::TcpServer::GetListPeerId()</a>, <a class="el" href="_tcp_client_8cpp-source.html#l00062">Omiscid::TcpClient::GetListPeerId()</a>, <a class="el" href="_connector_8cpp-source.html#l00532">Omiscid::Connector::GetListPeerId()</a>, <a class="el" href="_tcp_client_8cpp-source.html#l00057">Omiscid::TcpClient::GetPeerId()</a>, <a class="el" href="_connector_8cpp-source.html#l00604">Omiscid::ClientConnection::GetPeerPid()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00911">Send()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01013">SendCuttedMsg()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01129">SendPreparedBuffer()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01189">SendTo()</a>, <a class="el" href="_connector_8cpp-source.html#l00214">Omiscid::Connector::SendToAll()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l00601">Stop()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01480"></a>01480 {
<a name="l01481"></a>01481     <span class="keywordflow">return</span> peer_pid;
<a name="l01482"></a>01482 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ed776388f004399875e8629248d4f655"></a><!-- doxytag: member="Omiscid::MsgSocket::ReceivedSyncLinkMsg" ref="ed776388f004399875e8629248d4f655" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::ReceivedSyncLinkMsg           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
test if the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> has received the link message 
<p>
An link message is exchanged when the socket are connected. The extremity can then exchange their id <dl class="return" compact><dt><b>Returns:</b></dt><dd>true if the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> has received an empty message </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01484">1484</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_msg_socket_8cpp-source.html#l01499">WaitSyncLinkMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01485"></a>01485 {
<a name="l01486"></a>01486     <span class="keywordtype">bool</span> tmpb;
<a name="l01487"></a>01487     <a class="code" href="class_omiscid_1_1_smart_locker.html" title="SmartLocker can check the lock is removed and them unlock it when destroyed. This...">SmartLocker</a> SL_protectSend(protectSend);
<a name="l01488"></a>01488 
<a name="l01489"></a>01489     tmpb = receivedSyncLinkMsg;
<a name="l01490"></a>01490 
<a name="l01491"></a>01491     <span class="keywordflow">return</span> tmpb;
<a name="l01492"></a>01492 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7d87ebb3ed18bb10f3074e2730feb9e6"></a><!-- doxytag: member="Omiscid::MsgSocket::WaitSyncLinkMsg" ref="7d87ebb3ed18bb10f3074e2730feb9e6" args="(unsigned int TimeToWait=250)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::WaitSyncLinkMsg           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>TimeToWait</em> = <code>250</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
wait for a synclink message 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>TimeToWait</em>&nbsp;</td><td>the max time to wait in ms (default 250 ms) </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> has received a SyncLink message before timeout </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01499">1499</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_msg_socket_8cpp-source.html#l01484">ReceivedSyncLinkMsg()</a>, and <a class="el" href="_thread_8cpp-source.html#l00201">Omiscid::Thread::Sleep()</a>.</p>

<p>Referenced by <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01500"></a>01500 {
<a name="l01501"></a>01501     ElapsedTime CountWaitedTime;
<a name="l01502"></a>01502     <span class="keywordflow">while</span>( connected == <span class="keyword">true</span> )
<a name="l01503"></a>01503     {
<a name="l01504"></a>01504         <span class="keywordflow">if</span> ( <a class="code" href="class_omiscid_1_1_msg_socket.html#ed776388f004399875e8629248d4f655" title="test if the Socket has received the link message">ReceivedSyncLinkMsg</a>() )
<a name="l01505"></a>01505         {
<a name="l01506"></a>01506             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01507"></a>01507         }
<a name="l01508"></a>01508         <span class="keywordflow">if</span> ( CountWaitedTime.Get() &gt;= TimeToWait )
<a name="l01509"></a>01509         {
<a name="l01510"></a>01510             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01511"></a>01511         }
<a name="l01512"></a>01512         <a class="code" href="class_omiscid_1_1_thread.html#78678cf0e10de6fcec7ea20faf1a2c5c" title="the calling thread sleep">Thread::Sleep</a>(10);
<a name="l01513"></a>01513     }
<a name="l01514"></a>01514     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01515"></a>01515 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3ea7ed453da5945b9268aaf374059388"></a><!-- doxytag: member="Omiscid::MsgSocket::SyncLinkMsgSent" ref="3ea7ed453da5945b9268aaf374059388" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::SyncLinkMsgSent           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
test if the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> has sent the link message 
<p>
An link message is exchanged when the socket are connected. The extremity can then exchange their id <dl class="return" compact><dt><b>Returns:</b></dt><dd>true if the <a class="el" href="class_omiscid_1_1_socket.html" title="Socket for tcp or udp communication.">Socket</a> has received an empty message </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01517">1517</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01518"></a>01518 {
<a name="l01519"></a>01519     <span class="keywordflow">return</span> sendSyncLinkMsg;
<a name="l01520"></a>01520 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="30b58f15022ccc68fc521c4c34429892"></a><!-- doxytag: member="Omiscid::MsgSocket::GetMaxMessageSizeForTCP" ref="30b58f15022ccc68fc521c4c34429892" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MsgSocket::GetMaxMessageSizeForTCP           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
size max for message on TCP 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the size max accepted for exchange on TCP </dd></dl>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_tcp_client.html#6b5496b778d2e3389c0089315f726fa6">Omiscid::TcpClient</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01522">1522</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, and <a class="el" href="_tcp_client_8cpp-source.html#l00073">Omiscid::TcpClient::GetMaxMessageSizeForTCP()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01523"></a>01523 {
<a name="l01524"></a>01524     <span class="keywordflow">return</span> maxMessageSizeForTCP;
<a name="l01525"></a>01525 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8763f358c828376a54834a2a7520a603"></a><!-- doxytag: member="Omiscid::MsgSocket::operator==" ref="8763f358c828376a54834a2a7520a603" args="(unsigned int peer_id) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::operator==           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>peer_id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compare the peer id. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>peer_id</em>&nbsp;</td><td>[in] peer id to compare </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if the peer id for this socket has the value 'peer_id' </dd></dl>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01543">1543</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01544"></a>01544 {
<a name="l01545"></a>01545     <span class="keywordflow">return</span> peer_pid == peer_id;
<a name="l01546"></a>01546 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="853ad7a7a3b7ea7afa9dff79a74ddc1a"></a><!-- doxytag: member="Omiscid::MsgSocket::SetTcpNoDelay" ref="853ad7a7a3b7ea7afa9dff79a74ddc1a" args="(bool Set=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::SetTcpNoDelay           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>Set</em> = <code>true</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the undelying socket in non buffering mode if possible. 
<p>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_tcp_server.html#e823fd6db6437dcd3b06b30f94fd6be8">Omiscid::TcpServer</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01548">1548</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>References <a class="el" href="_socket_8cpp-source.html#l00615">Omiscid::Socket::SetTcpNoDelay()</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, and <a class="el" href="_control_client_8cpp-source.html#l00233">Omiscid::ControlClient::ControlClient()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01549"></a>01549 {
<a name="l01550"></a>01550     <span class="keywordflow">return</span> socket-&gt;<a class="code" href="class_omiscid_1_1_socket.html#2badd58f9743e72af87a3abcabc6a961">SetTcpNoDelay</a>(Set);
<a name="l01551"></a>01551 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="626bf84517ed66dd14358ba09da0dac4"></a><!-- doxytag: member="Omiscid::MsgSocket::AcceptConnection" ref="626bf84517ed66dd14358ba09da0dac4" args="(MsgSocket *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MsgSocket::AcceptConnection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_omiscid_1_1_msg_socket.html">MsgSocket</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accept new TCP connection. 
<p>
method called by TCP or <a class="el" href="class_omiscid_1_1_connector.html" title="Group TCP and UDP communication means.">Connector</a> server when it accepts new connection. (method called by AcceptConnection()) Default Implementation : Close the connection. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>object created with the new accepted TCP connection </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if the connection is accepted </dd></dl>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_tcp_server.html#bcdbecbc9f2dc8451856557925e72d4c">Omiscid::TcpServer</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l00904">904</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>

<p>Referenced by <a class="el" href="_msg_socket_8cpp-source.html#l00568">Run()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00905"></a>00905 {
<a name="l00906"></a>00906     <span class="comment">//std::cerr &lt;&lt; "in MsgSocket::acceptConnection(MsgSocket*)\n";</span>
<a name="l00907"></a>00907     <span class="keyword">delete</span> ms;
<a name="l00908"></a>00908     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00909"></a>00909 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0a89a1c77bf9ff30f5fe2c130191429b"></a><!-- doxytag: member="Omiscid::MsgSocket::AcceptConnection" ref="0a89a1c77bf9ff30f5fe2c130191429b" args="(const UdpConnection &amp;udp_connect, bool msg_empty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> * MsgSocket::AcceptConnection           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_omiscid_1_1_udp_connection.html">UdpConnection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>udp_connect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>msg_empty</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accept new UDP connection. 
<p>
Used for the kind UDP_EXCHANGE Enable to store new source that declare itself with an empty message, and return NULL if the message is not empty and the source not already known.<p>
(to implement in child class) current implementation : display a message on error output, and return NULL. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>udp_connect</em>&nbsp;</td><td>[in] information about the source of a message coming from UDP. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg_empty</em>&nbsp;</td><td>[in] true if udp_connect is the source of an empty message </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>NULL if refuse the message, else return an object linked to the same source </dd></dl>

<p>Reimplemented in <a class="el" href="class_omiscid_1_1_connector.html#c812dbd9cc446c38f95d3767a7b98dbc">Omiscid::Connector</a>, and <a class="el" href="class_omiscid_1_1_udp_exchange.html#1b38216d40b38624b537c92a2fa4aa7c">Omiscid::UdpExchange</a>.</p>

<p>Definition at line <a class="el" href="_msg_socket_8cpp-source.html#l01290">1290</a> of file <a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01291"></a>01291 {
<a name="l01292"></a>01292     OmiscidTrace( <span class="stringliteral">"AcceptConnection UDP (2)\n"</span>);
<a name="l01293"></a>01293     <span class="keywordflow">if</span>(msg_empty)
<a name="l01294"></a>01294     {
<a name="l01295"></a>01295         OmiscidTrace( <span class="stringliteral">"[Empty Msg]\n"</span>);
<a name="l01296"></a>01296     }
<a name="l01297"></a>01297     OmiscidTrace( <span class="stringliteral">"\n"</span>);
<a name="l01298"></a>01298     <span class="keywordflow">return</span> NULL;
<a name="l01299"></a>01299 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="0d5c96d03589cdf47a3803ac3365249d"></a><!-- doxytag: member="Omiscid::MsgSocket::CallbackObjects" ref="0d5c96d03589cdf47a3803ac3365249d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_mutexed_simple_list.html">MutexedSimpleList</a>&lt;<a class="el" href="class_omiscid_1_1_msg_socket_callback_object.html">MsgSocketCallbackObject</a>*&gt; <a class="el" href="class_omiscid_1_1_msg_socket.html#0d5c96d03589cdf47a3803ac3365249d">Omiscid::MsgSocket::CallbackObjects</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
callback call when messages arrive 
<p>Definition at line <a class="el" href="_msg_socket_8h-source.html#l00392">392</a> of file <a class="el" href="_msg_socket_8h-source.html">MsgSocket.h</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00415">AddCallbackObject()</a>, <a class="el" href="_connector_8cpp-source.html#l00118">Omiscid::Connector::ConnectTo()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00462">RemoveAllCallbackObjects()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00440">RemoveCallbackObject()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l00911">Send()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01013">SendCuttedMsg()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01129">SendPreparedBuffer()</a>, <a class="el" href="_msg_socket_8cpp-source.html#l01189">SendTo()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l00601">Stop()</a>.</p>

</div>
</div><p>
<a class="anchor" name="deba601f8dc26650cf4168a4bcc2c03a"></a><!-- doxytag: member="Omiscid::MsgSocket::callbackData" ref="deba601f8dc26650cf4168a4bcc2c03a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_msg_socket_call_back_data.html">MsgSocketCallBackData</a> <a class="el" href="class_omiscid_1_1_msg_socket.html#deba601f8dc26650cf4168a4bcc2c03a">Omiscid::MsgSocket::callbackData</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
structure given to the callback methods 
<p>Definition at line <a class="el" href="_msg_socket_8h-source.html#l00393">393</a> of file <a class="el" href="_msg_socket_8h-source.html">MsgSocket.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="f8de8404f66db44e0a1beed0d48abb7f"></a><!-- doxytag: member="Omiscid::MsgSocket::mutex" ref="f8de8404f66db44e0a1beed0d48abb7f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_mutex.html">Mutex</a> <a class="el" href="class_omiscid_1_1_msg_socket.html#f8de8404f66db44e0a1beed0d48abb7f">Omiscid::MsgSocket::mutex</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
mutex to protect the callback access 
<p>Definition at line <a class="el" href="_msg_socket_8h-source.html#l00395">395</a> of file <a class="el" href="_msg_socket_8h-source.html">MsgSocket.h</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l00471">SetCallbackSyncLink()</a>.</p>

</div>
</div><p>
<a class="anchor" name="eafc599eec5aca8cfeea9727bf984f46"></a><!-- doxytag: member="Omiscid::MsgSocket::callbackSyncLinkFct" ref="eafc599eec5aca8cfeea9727bf984f46" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_omiscid_1_1_msg_socket.html#755a9ab6299c74f203aec3ae5a4a4c47">Callback_SyncLink</a> <a class="el" href="class_omiscid_1_1_msg_socket.html#eafc599eec5aca8cfeea9727bf984f46">Omiscid::MsgSocket::callbackSyncLinkFct</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
callback call when SyncLink messages arrive 
<p>Definition at line <a class="el" href="_msg_socket_8h-source.html#l00396">396</a> of file <a class="el" href="_msg_socket_8h-source.html">MsgSocket.h</a>.</p>

<p>Referenced by <a class="el" href="_tcp_server_8cpp-source.html#l00283">Omiscid::TcpServer::AcceptConnection()</a>, and <a class="el" href="_msg_socket_8cpp-source.html#l00471">SetCallbackSyncLink()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>Com/Com/<a class="el" href="_msg_socket_8h-source.html">MsgSocket.h</a><li>Com/<a class="el" href="_msg_socket_8cpp-source.html">MsgSocket.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 1 08:17:00 2008 for OMiSCID(aka O3MiSCID) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
